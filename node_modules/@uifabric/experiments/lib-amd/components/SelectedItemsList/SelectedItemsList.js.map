{"version":3,"file":"SelectedItemsList.js","sourceRoot":"../src/","sources":["components/SelectedItemsList/SelectedItemsList.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { ISelectedItemsList, ISelectedItemsListProps, BaseSelectedItem } from './SelectedItemsList.types';\n\nconst _SelectedItemsList = <TItem extends BaseSelectedItem>(\n  props: ISelectedItemsListProps<TItem>,\n  ref: React.Ref<ISelectedItemsList<TItem>>,\n) => {\n  const { dragDropEvents, dragDropHelper, selectedItems, defaultSelectedItems, replaceItem } = props;\n  const [items, setItems] = React.useState(selectedItems || defaultSelectedItems || []);\n\n  const renderedItems = React.useMemo(() => items, [items]);\n  const didMountRef = React.useRef(false);\n\n  React.useEffect(() => {\n    // block first call of the hook and forward each consecutive one\n    // We do this so that if defaultSelectedItems are set, they don't get overwritten\n    if (didMountRef.current) {\n      setItems(selectedItems || []);\n    } else {\n      didMountRef.current = true;\n    }\n  }, [selectedItems]);\n\n  const removeItems = (itemsToRemove: TItem[]): void => {\n    // Intentionally not using .filter here as we want to only remove a specific\n    // item in case of duplicates of same item.\n    const updatedItems: TItem[] = [...items];\n    itemsToRemove.forEach(item => {\n      const index: number = updatedItems.indexOf(item);\n      updatedItems.splice(index, 1);\n    });\n    setItems(updatedItems);\n    props.onItemsRemoved?.(itemsToRemove);\n  };\n\n  const _replaceItem = React.useCallback(\n    (newItem: TItem | TItem[], index: number): void => {\n      const newItemsArray = !Array.isArray(newItem) ? [newItem] : newItem;\n\n      if (index >= 0) {\n        const newItems: TItem[] = [...items];\n        newItems.splice(index, 1, ...newItemsArray);\n        setItems(newItems);\n        replaceItem?.(newItem, index);\n      }\n    },\n    [items, replaceItem],\n  );\n\n  const onRemoveItemCallbacks = React.useMemo(\n    () =>\n      // create callbacks ahead of time with memo.\n      // (hooks have to be called in the same order)\n      items.map((item: TItem) => () => removeItems([item])),\n    // TODO: consider whether dependency on removeItems should be added\n    // (removeItems would likely need to be wrapped in useCallback)\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [items],\n  );\n\n  const SelectedItem = props.onRenderItem;\n  return (\n    <>\n      {items.length > 0 && (\n        <div role={'list'}>\n          {SelectedItem &&\n            renderedItems.map((item: TItem, index: number) => (\n              <SelectedItem\n                item={item}\n                index={index}\n                // To keep react from complaining for duplicate elements with the same key\n                // we will append the index to the key so that we have unique key for each item\n                key={item.key !== undefined ? item.key + '_' + index : index}\n                selected={props.focusedItemIndices?.includes(index)}\n                removeButtonAriaLabel={props.removeButtonAriaLabel}\n                onRemoveItem={onRemoveItemCallbacks[index]}\n                onItemChange={_replaceItem}\n                dragDropEvents={dragDropEvents}\n                dragDropHelper={dragDropHelper}\n                createGenericItem={props.createGenericItem}\n              />\n            ))}\n        </div>\n      )}\n    </>\n  );\n};\n\n// Typescript only respects unifying a generic type with a generic const _function_ of the same name for function types.\n// In order to satisfy the type checker, here we lie about the type of the const so that it is still a generic function.\nexport type SelectedItemsList<TItem extends BaseSelectedItem> = React.Component<ISelectedItemsListProps<TItem>>;\nexport const SelectedItemsList = React.forwardRef(_SelectedItemsList) as typeof _SelectedItemsList;\n"]}