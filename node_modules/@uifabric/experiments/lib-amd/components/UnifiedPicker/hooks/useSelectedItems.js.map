{"version":3,"file":"useSelectedItems.js","sourceRoot":"../src/","sources":["components/UnifiedPicker/hooks/useSelectedItems.ts"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { Selection } from '../../../Utilities';\n\nexport interface IUseSelectedItemsResponse<T> {\n  selectedItems: T[];\n  setSelectedItems: (items: T[]) => void;\n  addItems: (items: T[]) => void;\n  dropItemsAt: (insertIndex: number, itemsToAdd: T[], indicesToRemove: number[]) => void;\n  removeItemAt: (index: number) => void;\n  removeItem: (item: T) => void;\n  replaceItem: (itemToReplace: T, itemsToReplaceWith: T[]) => void;\n  removeItems: (itemsToRemove: T[]) => void;\n  removeSelectedItems: () => void;\n  getSelectedItems: () => T[];\n  hasSelectedItems: () => boolean;\n  unselectAll: () => void;\n}\n\nexport const useSelectedItems = <T extends {}>(\n  selection: Selection,\n  selectedItems?: T[],\n): IUseSelectedItemsResponse<T> => {\n  const [items, setSelectedItems] = React.useState(selectedItems || []);\n\n  React.useEffect(\n    () => {\n      if (selectedItems !== undefined) {\n        selection.setItems(selectedItems);\n      }\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- we want to do this once\n    [],\n  );\n\n  React.useEffect(() => {\n    setSelectedItems(selectedItems ? selectedItems : []);\n  }, [selectedItems]);\n\n  const addItems = React.useCallback(\n    (itemsToAdd: T[]): void => {\n      const newItems: T[] = items.concat(itemsToAdd);\n      setSelectedItems(newItems);\n      selection.setItems(newItems);\n    },\n    [items, selection],\n  );\n\n  const dropItemsAt = React.useCallback(\n    (insertIndex: number, itemsToAdd: T[], indicesToRemove: number[]): void => {\n      const currentItems: T[] = [...items];\n      const updatedItems: T[] = [];\n\n      for (let i = 0; i < currentItems.length; i++) {\n        const item = currentItems[i];\n        // If this is the insert before index, insert the dragged items, then the current item\n        if (i === insertIndex) {\n          itemsToAdd.forEach(draggedItem => {\n            updatedItems.push(draggedItem);\n          });\n        }\n        if (!indicesToRemove.includes(i)) {\n          // only insert items into the new list that are not being dragged\n          updatedItems.push(item);\n        }\n      }\n      // if the insert index is at the end, add them now\n      if (insertIndex === currentItems.length) {\n        itemsToAdd.forEach(draggedItem => {\n          updatedItems.push(draggedItem);\n        });\n      }\n      setSelectedItems(updatedItems);\n      selection.setItems(updatedItems);\n    },\n    [items, selection],\n  );\n\n  const removeItemAt = React.useCallback(\n    (index: number): void => {\n      const currentItems: T[] = [...items];\n      const updatedItems: T[] = currentItems.slice(0, index).concat(currentItems.slice(index + 1));\n      setSelectedItems(updatedItems);\n      selection.setItems(updatedItems);\n    },\n    [items, selection],\n  );\n\n  const removeItem = React.useCallback(\n    (item: T): void => {\n      const currentItems: T[] = [...items];\n      const index: number = currentItems.indexOf(item);\n      removeItemAt(index);\n    },\n    [items, removeItemAt],\n  );\n\n  const replaceItem = React.useCallback(\n    (itemToReplace: T, itemsToReplaceWith: T[]): void => {\n      const currentItems: T[] = [...items];\n      const index: number = items.indexOf(itemToReplace);\n\n      if (index > -1) {\n        const updatedItems = currentItems\n          .slice(0, index)\n          .concat(itemsToReplaceWith)\n          .concat(currentItems.slice(index + 1));\n        setSelectedItems(updatedItems);\n        selection.setItems(updatedItems);\n      }\n    },\n    [items, selection],\n  );\n\n  const removeItems = React.useCallback(\n    (itemsToRemove: any[]): void => {\n      const currentItems: T[] = [...items];\n      const updatedItems: T[] = currentItems;\n      // Intentionally not using .filter here as we want to only remove a specific\n      // item in case of duplicates of same item.\n      itemsToRemove.forEach(item => {\n        const index: number = updatedItems.indexOf(item);\n        updatedItems.splice(index, 1);\n      });\n      setSelectedItems(updatedItems);\n      selection.setItems(updatedItems);\n    },\n    [items, selection],\n  );\n\n  const hasSelectedItems = React.useCallback((): Boolean => {\n    if (items.length && selection.getSelectedCount() > 0) {\n      return true;\n    } else {\n      return false;\n    }\n  }, [items.length, selection]);\n\n  const getSelectedItems = React.useCallback((): T[] => {\n    if (hasSelectedItems()) {\n      return selection.getSelection() as T[];\n    } else {\n      return [];\n    }\n  }, [hasSelectedItems, selection]);\n\n  const removeSelectedItems = React.useCallback((): void => {\n    removeItems(getSelectedItems());\n  }, [removeItems, getSelectedItems]);\n\n  const unselectAll = React.useCallback((): void => {\n    if (hasSelectedItems()) {\n      selection.setAllSelected(false);\n    }\n  }, [hasSelectedItems, selection]);\n\n  return {\n    selectedItems: items,\n    setSelectedItems: setSelectedItems,\n    addItems: addItems,\n    dropItemsAt: dropItemsAt,\n    removeItemAt: removeItemAt,\n    removeItem: removeItem,\n    replaceItem: replaceItem,\n    removeItems: removeItems,\n    removeSelectedItems: removeSelectedItems,\n    getSelectedItems: getSelectedItems,\n    hasSelectedItems: hasSelectedItems,\n    unselectAll: unselectAll,\n  } as IUseSelectedItemsResponse<T>;\n};\n"]}