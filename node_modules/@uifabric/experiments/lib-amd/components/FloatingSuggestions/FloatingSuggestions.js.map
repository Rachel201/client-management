{"version":3,"file":"FloatingSuggestions.js","sourceRoot":"../src/","sources":["components/FloatingSuggestions/FloatingSuggestions.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport * as styles from './FloatingSuggestions.scss';\nimport { Async, initializeComponentRef, css, KeyCodes } from 'office-ui-fabric-react/lib/Utilities';\nimport { Callout, DirectionalHint } from 'office-ui-fabric-react/lib/Callout';\nimport {\n  IFloatingSuggestions,\n  IFloatingSuggestionsProps,\n  IFloatingSuggestionsInnerSuggestionProps,\n} from './FloatingSuggestions.types';\nimport { ISuggestionModel } from 'office-ui-fabric-react/lib/Pickers';\nimport { SuggestionsControl } from './Suggestions/SuggestionsControl';\nimport { SuggestionsStore } from './Suggestions/SuggestionsStore';\n\nexport interface IFloatingSuggestionsState {\n  queryString: string;\n  suggestionsVisible?: boolean;\n  didBind: boolean;\n}\n\nexport class FloatingSuggestions<TItem>\n  extends React.Component<IFloatingSuggestionsProps<TItem>, IFloatingSuggestionsState>\n  implements IFloatingSuggestions<TItem> {\n  private root = React.createRef<HTMLDivElement>();\n  private suggestionStore: SuggestionsStore<TItem>;\n  private suggestionsControl: React.RefObject<SuggestionsControl<TItem>> = React.createRef();\n  private currentPromise: PromiseLike<TItem[]>;\n  private isComponentMounted: boolean = false;\n  private _async: Async;\n\n  constructor(basePickerProps: IFloatingSuggestionsProps<TItem>) {\n    super(basePickerProps);\n\n    this._async = new Async(this);\n    initializeComponentRef(this);\n\n    this.suggestionStore = basePickerProps.suggestionsStore;\n    this.state = {\n      queryString: '',\n      didBind: false,\n    };\n  }\n\n  // TODO FloatingSuggestions should not be responsible for getting the\n  // input text.\n  public get inputText(): string {\n    return this.state.queryString;\n  }\n\n  public get suggestions(): ISuggestionModel<TItem>[] {\n    return this.suggestionStore.suggestions;\n  }\n\n  public forceResolveSuggestion(): void {\n    if (this.suggestionsControl.current && this.suggestionsControl.current.hasSuggestionSelected()) {\n      this.onCurrentlySelectedSuggestionChosen();\n    } else {\n      this._validateAndInsertCurrentQueryString();\n    }\n  }\n\n  public get currentSelectedSuggestionIndex(): number {\n    return this.suggestionsControl.current ? this.suggestionsControl.current.currentSuggestionIndex : -1;\n  }\n\n  public get isSuggestionsShown(): boolean {\n    return this.state.suggestionsVisible === undefined ? false : this.state.suggestionsVisible;\n  }\n\n  public onQueryStringChanged = (queryString: string): void => {\n    if (queryString !== this.state.queryString) {\n      this.setState({\n        queryString: queryString,\n      });\n\n      if (this.props.onInputChanged) {\n        this.props.onInputChanged(queryString);\n      }\n\n      this.updateValue(queryString);\n    }\n  };\n\n  public hidePicker = (): void => {\n    if (this.props.onSuggestionsHidden && this.isSuggestionsShown) {\n      this.props.onSuggestionsHidden();\n    }\n\n    this.setState({\n      suggestionsVisible: false,\n    });\n  };\n\n  public showPicker = (updateValue: boolean = false): void => {\n    if (this.props.onSuggestionsShown && !this.isSuggestionsShown) {\n      this.props.onSuggestionsShown();\n    }\n\n    this.setState({\n      suggestionsVisible: true,\n    });\n\n    // Update the suggestions if updateValue == true\n    const value = this.props.inputElement ? this.props.inputElement.value : '';\n    if (updateValue) {\n      this.updateValue(value);\n    }\n  };\n\n  public componentDidMount(): void {\n    this._bindToInputElement();\n    this.isComponentMounted = true;\n\n    this._onResolveSuggestions = this._async.debounce(this._onResolveSuggestions, this.props.resolveDelay);\n  }\n\n  public componentDidUpdate(): void {\n    this._bindToInputElement();\n  }\n\n  public componentWillUnmount(): void {\n    this._unbindFromInputElement();\n    this.isComponentMounted = false;\n    this._async.dispose();\n  }\n\n  public UNSAFE_componentWillReceiveProps(newProps: IFloatingSuggestionsProps<TItem>): void {\n    if (newProps.suggestionItems) {\n      this.updateSuggestions(newProps.suggestionItems);\n    }\n  }\n\n  public onCurrentlySelectedSuggestionChosen = (): void => {\n    if (this.suggestionsControl.current && this.suggestionsControl.current.hasSuggestionSelected()) {\n      this._onSuggestionSelected(this.suggestionsControl.current.currentSuggestion!.item);\n    }\n  };\n\n  public updateSuggestions(suggestions: TItem[], forceUpdate: boolean = false): void {\n    this.suggestionStore.updateSuggestions(suggestions);\n\n    if (forceUpdate) {\n      this.forceUpdate();\n    }\n  }\n\n  public render(): JSX.Element {\n    const { className } = this.props;\n    return (\n      <div ref={this.root} className={css('ms-BasePicker ms-BaseFloatingPicker', className ? className : '')}>\n        {this._renderSuggestions()}\n      </div>\n    );\n  }\n\n  public updateValue(updatedValue: string): void {\n    if (updatedValue === '') {\n      this.updateSuggestionWithZeroState();\n    } else {\n      this._onResolveSuggestions(updatedValue);\n    }\n  }\n\n  public updateSuggestionWithZeroState(): void {\n    if (this.props.onZeroQuerySuggestion) {\n      const suggestions: TItem[] | PromiseLike<TItem[]> | null = this.props.onZeroQuerySuggestion();\n      this.updateSuggestionsList(suggestions || []);\n    } else {\n      this.hidePicker();\n    }\n  }\n\n  public updateSuggestionsList(suggestions: TItem[] | PromiseLike<TItem[]>): void {\n    // Check to see if the returned value is an array, if it is then just pass it into the next function.\n    // If the returned value is not an array then check to see if it's a promise or PromiseLike.\n    // If it is then resolve it asynchronously.\n    if (Array.isArray(suggestions)) {\n      this.updateSuggestions(suggestions, true /*forceUpdate*/);\n    } else if (suggestions && suggestions.then) {\n      // Ensure that the promise will only use the callback if it was the most recent one.\n      const promise: PromiseLike<TItem[]> = (this.currentPromise = suggestions);\n      promise.then((newSuggestions: TItem[]) => {\n        // Only update if the next promise has not yet resolved and\n        // the floating picker is still mounted.\n        if (promise === this.currentPromise && this.isComponentMounted) {\n          this.updateSuggestions(newSuggestions, true /*forceUpdate*/);\n        }\n      });\n    }\n  }\n\n  private _renderSuggestions(): JSX.Element | null {\n    // Express this as 2 separate statements instead of a single one, because `undefined` isn't filtered out of the type\n    // when using `|| SuggestionsControl`\n    let TypedSuggestionsControl: React.ComponentType<IFloatingSuggestionsInnerSuggestionProps<TItem>> | undefined = this\n      .props.onRenderSuggestionControl;\n    if (TypedSuggestionsControl === undefined) {\n      TypedSuggestionsControl = SuggestionsControl;\n    }\n\n    return this.state.suggestionsVisible ? (\n      <Callout\n        className={styles.callout}\n        isBeakVisible={false}\n        gapSpace={5}\n        target={this.props.inputElement}\n        onDismiss={this.hidePicker}\n        directionalHint={DirectionalHint.bottomLeftEdge}\n        directionalHintForRTL={DirectionalHint.bottomRightEdge}\n        calloutWidth={this.props.calloutWidth ? this.props.calloutWidth : 0}\n      >\n        <TypedSuggestionsControl\n          onRenderSuggestion={this.props.onRenderSuggestionsItem}\n          onSuggestionClick={this._onSuggestionClick}\n          onSuggestionRemove={this._onSuggestionRemove}\n          suggestions={this.suggestionStore.getSuggestions()}\n          componentRef={this.suggestionsControl}\n          onCurrentlySelectedSuggestionChosen={this.onCurrentlySelectedSuggestionChosen}\n          shouldLoopSelection={false}\n        />\n      </Callout>\n    ) : null;\n  }\n\n  private _onSuggestionSelected(item: TItem): void {\n    if (this.props.onSuggestionSelected) {\n      this.props.onSuggestionSelected(item);\n    }\n  }\n\n  private _onSuggestionClick = (ev: React.MouseEvent<HTMLElement>, item: TItem, index: number): void => {\n    this._onSuggestionSelected(item);\n    this._updateSuggestionsVisible(false /*shouldShow*/);\n  };\n\n  private _onSuggestionRemove = (ev: React.MouseEvent<HTMLElement>, item: TItem, index: number): void => {\n    if (this.props.onRemoveSuggestion) {\n      this.props.onRemoveSuggestion(item);\n    }\n\n    if (this.suggestionsControl.current) {\n      this.suggestionsControl.current.removeSuggestion(index);\n    }\n  };\n\n  private _onKeyDown = (ev: MouseEvent): void => {\n    if (\n      !this.state.suggestionsVisible ||\n      (this.props.inputElement && ev.target instanceof Node && !this.props.inputElement.contains(ev.target))\n    ) {\n      return;\n    }\n    // eslint-disable-next-line deprecation/deprecation\n    const keyCode = ev.which;\n    switch (keyCode) {\n      case KeyCodes.escape:\n        this.hidePicker();\n        ev.preventDefault();\n        ev.stopPropagation();\n        break;\n\n      case KeyCodes.tab:\n      case KeyCodes.enter:\n        if (\n          !ev.shiftKey &&\n          !ev.ctrlKey &&\n          this.suggestionsControl.current &&\n          this.suggestionsControl.current.handleKeyDown(keyCode)\n        ) {\n          ev.preventDefault();\n          ev.stopPropagation();\n        } else {\n          // no selection. Try to force resolve the current query\n          this._validateAndInsertCurrentQueryString();\n        }\n        break;\n\n      case KeyCodes.del:\n        if (\n          this.props.onRemoveSuggestion &&\n          this.suggestionsControl.current &&\n          this.suggestionsControl.current.hasSuggestionSelected &&\n          this.suggestionsControl.current.currentSuggestion &&\n          ev.shiftKey\n        ) {\n          this.props.onRemoveSuggestion(this.suggestionsControl.current.currentSuggestion!.item);\n\n          this.suggestionsControl.current.removeSuggestion();\n          this.forceUpdate();\n          ev.stopPropagation();\n        }\n        break;\n\n      case KeyCodes.up:\n        if (this.suggestionsControl.current && this.suggestionsControl.current.handleKeyDown(keyCode)) {\n          ev.preventDefault();\n          ev.stopPropagation();\n          this._updateActiveDescendant();\n        }\n        break;\n\n      case KeyCodes.down:\n        if (this.suggestionsControl.current && this.suggestionsControl.current.handleKeyDown(keyCode)) {\n          ev.preventDefault();\n          ev.stopPropagation();\n          this._updateActiveDescendant();\n        }\n        break;\n    }\n  };\n\n  private _updateActiveDescendant(): void {\n    if (this.props.inputElement && this.suggestionsControl.current && this.suggestionsControl.current.selectedElement) {\n      const selectedElId = this.suggestionsControl.current.selectedElement.getAttribute('id');\n      if (selectedElId) {\n        this.props.inputElement.setAttribute('aria-activedescendant', selectedElId);\n      }\n    }\n  }\n\n  private _onResolveSuggestions(updatedValue: string): void {\n    const suggestions: TItem[] | PromiseLike<TItem[]> | null = this.props.onResolveSuggestions(updatedValue);\n\n    this._updateSuggestionsVisible(true /*shouldShow*/);\n    if (suggestions !== null) {\n      this.updateSuggestionsList(suggestions);\n    }\n  }\n\n  private _validateAndInsertCurrentQueryString = (): void => {\n    if (this.state.queryString && this.props.isQueryForceResolveable && this.props.createForceResolvedItem) {\n      const isForceResolvable: boolean = this.props.isQueryForceResolveable(this.state.queryString);\n      if (!isForceResolvable) {\n        return;\n      }\n\n      const itemToConvert: ISuggestionModel<TItem> = this.props.createForceResolvedItem(this.state.queryString);\n      const convertedItems = this.suggestionStore.convertSuggestionsToSuggestionItems([itemToConvert]);\n      this._onSuggestionSelected(convertedItems[0].item);\n    }\n  };\n\n  private _updateSuggestionsVisible(shouldShow: boolean): void {\n    if (shouldShow) {\n      this.showPicker();\n    } else {\n      this.hidePicker();\n    }\n  }\n\n  private _bindToInputElement(): void {\n    if (this.props.inputElement && !this.state.didBind) {\n      this.props.inputElement.addEventListener('keydown', this._onKeyDown);\n      this.setState({ didBind: true });\n    }\n  }\n\n  private _unbindFromInputElement(): void {\n    if (this.props.inputElement && this.state.didBind) {\n      this.props.inputElement.removeEventListener('keydown', this._onKeyDown);\n      this.setState({ didBind: false });\n    }\n  }\n}\n"]}