{"version":3,"file":"FloatingSuggestions.js","sourceRoot":"../src/","sources":["components/FloatingSuggestionsComposite/FloatingSuggestions.tsx"],"names":[],"mappings":"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","sourcesContent":["import { IBaseFloatingSuggestionsProps } from './FloatingSuggestions.types';\nimport { Callout, DirectionalHint } from 'office-ui-fabric-react/lib/Callout';\nimport * as React from 'react';\nimport { getStyles } from './FloatingSuggestions.styles';\nimport { classNamesFunction, css } from '../../Utilities';\nimport { IBaseFloatingSuggestionsStyles, IBaseFloatingSuggestionsStylesProps } from './FloatingSuggestions.types';\nimport { FloatingSuggestionsList } from './FloatingSuggestionsList/FloatingSuggestionsList';\n\nexport const BaseFloatingSuggestions = <T extends {}>(props: IBaseFloatingSuggestionsProps<T>): JSX.Element => {\n  const getClassNames = classNamesFunction<IBaseFloatingSuggestionsStylesProps, IBaseFloatingSuggestionsStyles>();\n  const classNames = getClassNames(getStyles);\n  const {\n    componentRef,\n    suggestions,\n    isSuggestionsVisible,\n    onSuggestionSelected,\n    onRemoveSuggestion,\n    onRenderSuggestion,\n    onRenderHeader,\n    onRenderFooter,\n    onRenderNoResultFound,\n    noResultsFoundText,\n    maximumSuggestionsToShow,\n    showSuggestionRemoveButton,\n    removeItemButtonAriaLabel,\n    suggestionsContainerAriaLabel,\n    selectedSuggestionIndex,\n    suggestionsHeaderText,\n    onFloatingSuggestionsDismiss,\n    targetElement,\n    calloutProps,\n    pickerWidth,\n    onKeyDown,\n    pickerSuggestionsProps,\n    selectedFooterIndex,\n    selectedHeaderIndex,\n    onSuggestionsShown,\n    onSuggestionsHidden,\n  } = props;\n\n  // Picker shown/hidden callback logic\n  // Ref gate to prevent the onHidden callback from being called the first time\n  const suggestionsCallbackGate = React.useRef(false);\n  React.useEffect(() => {\n    if (suggestionsCallbackGate.current || isSuggestionsVisible) {\n      if (isSuggestionsVisible) {\n        onSuggestionsShown?.();\n      } else {\n        onSuggestionsHidden?.();\n      }\n    }\n    suggestionsCallbackGate.current = true;\n  }, [isSuggestionsVisible, onSuggestionsShown, onSuggestionsHidden]);\n\n  const hidePicker = React.useCallback(\n    (ev?: React.MouseEvent): void => {\n      onFloatingSuggestionsDismiss?.(ev);\n    },\n    [onFloatingSuggestionsDismiss],\n  );\n\n  return (\n    <div\n      ref={componentRef}\n      className={css('ms-BasePicker ms-BaseFloatingPicker', classNames.root, props.className ? props.className : '')}\n    >\n      {isSuggestionsVisible ? (\n        <Callout\n          className={classNames.callout}\n          isBeakVisible={false}\n          gapSpace={5}\n          target={targetElement}\n          onDismiss={hidePicker}\n          onKeyDown={onKeyDown}\n          directionalHint={DirectionalHint.bottomLeftEdge}\n          directionalHintForRTL={DirectionalHint.bottomRightEdge}\n          {...calloutProps}\n        >\n          <FloatingSuggestionsList<T>\n            suggestionItems={suggestions}\n            onItemClick={onSuggestionSelected}\n            onSuggestionRemove={onRemoveSuggestion}\n            showSuggestionRemoveButton={showSuggestionRemoveButton}\n            removeItemAriaLabel={removeItemButtonAriaLabel}\n            onRenderItem={onRenderSuggestion}\n            onRenderHeader={onRenderHeader}\n            onRenderFooter={onRenderFooter}\n            headerItemsProps={pickerSuggestionsProps?.headerItemsProps}\n            footerItemsProps={pickerSuggestionsProps?.footerItemsProps}\n            onRenderNoResultFound={onRenderNoResultFound}\n            noResultsFoundText={noResultsFoundText}\n            maximumSuggestionsToShow={maximumSuggestionsToShow}\n            suggestionsContainerAriaLabel={suggestionsContainerAriaLabel}\n            selectedSuggestionIndex={selectedSuggestionIndex}\n            selectedFooterIndex={selectedFooterIndex}\n            selectedHeaderIndex={selectedHeaderIndex}\n            suggestionsHeaderText={suggestionsHeaderText}\n            pickerWidth={pickerWidth}\n            suggestionsHeaderContainerAriaLabel={pickerSuggestionsProps?.suggestionsHeaderContainerAriaLabel}\n            suggestionsFooterContainerAriaLabel={pickerSuggestionsProps?.suggestionsFooterContainerAriaLabel}\n          />\n        </Callout>\n      ) : null}\n    </div>\n  );\n};\n"]}