{"version":3,"file":"GroupedListSection.js","sourceRoot":"../src/","sources":["components/GroupedList/GroupedListSection.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport {\n  IGroup,\n  IGroupDividerProps\n} from './GroupedList.types';\n\nimport {\n  IDragDropContext,\n  IDragDropEvents,\n  IDragDropHelper\n} from '../../utilities/dragdrop/index';\n\nimport {\n  BaseComponent,\n  IRenderFunction,\n  IDisposable,\n  createRef\n} from '../../Utilities';\n\nimport {\n  ISelection,\n  SelectionMode,\n  SELECTION_CHANGE\n} from '../../utilities/selection/index';\n\nimport { GroupHeader } from './GroupHeader';\nimport { GroupShowAll } from './GroupShowAll';\nimport { GroupFooter } from './GroupFooter';\n\nimport {\n  List\n} from '../../List';\nimport {\n  IDragDropOptions\n} from './../../utilities/dragdrop/interfaces';\nimport { assign, css } from '../../Utilities';\nimport { IViewport } from '../../utilities/decorators/withViewport';\nimport * as stylesImport from './GroupedList.scss';\nimport { IListProps } from '../List/index';\n\nconst styles: any = stylesImport;\n\nexport interface IGroupedListSectionProps extends React.Props<GroupedListSection> {\n  /**\n   * Gets the component ref.\n   */\n  componentRef?: () => void;\n\n  /** Map of callback functions related to drag and drop functionality. */\n  dragDropEvents?: IDragDropEvents;\n\n  /** helper to manage drag/drop across item rows and groups */\n  dragDropHelper?: IDragDropHelper;\n\n  /** Event names and corresponding callbacks that will be registered to the group and the rendered elements */\n  eventsToRegister?: { eventName: string, callback: (context: IDragDropContext, event?: any) => void }[];\n\n  /** Information to pass in to the group footer. */\n  footerProps?: IGroupDividerProps;\n\n  /** Grouping item limit. */\n  getGroupItemLimit?: (group: IGroup) => number;\n\n  /** Optional grouping instructions. */\n  groupIndex?: number;\n\n  /** Optional group nesting level. */\n  groupNestingDepth?: number;\n\n  /** Optional grouping instructions. */\n  group?: IGroup;\n\n  /** Information to pass in to the group header. */\n  headerProps?: IGroupDividerProps;\n\n  /** List of items to render. */\n  items: any[];\n\n  /** Optional list props to pass to list renderer.  */\n  listProps?: any;\n\n  /** Rendering callback to render the group items. */\n  onRenderCell: (\n    nestingDepth?: number,\n    item?: any,\n    index?: number\n  ) => React.ReactNode;\n\n  /** Optional selection model to track selection state.  */\n  selection?: ISelection;\n\n  /** Controls how/if the details list manages selection. */\n  selectionMode?: SelectionMode;\n\n  /** Information to pass in to the group Show All footer. */\n  showAllProps?: IGroupDividerProps;\n\n  /** Optional Viewport, provided by the parent component. */\n  viewport?: IViewport;\n\n  /** Override for rendering the group header. */\n  onRenderGroupHeader?: IRenderFunction<IGroupDividerProps>;\n\n  /** Override for rendering the group Show All link. */\n  onRenderGroupShowAll?: IRenderFunction<IGroupDividerProps>;\n\n  /** Override for rendering the group footer. */\n  onRenderGroupFooter?: IRenderFunction<IGroupDividerProps>;\n\n  /**\n   * Optional callback to determine whether the list should be rendered in full, or virtualized.\n   * Virtualization will add and remove pages of items as the user scrolls them into the visible range.\n   * This benefits larger list scenarios by reducing the DOM on the screen, but can negatively affect performance for smaller lists.\n   * The default implementation will virtualize when this callback is not provided.\n   */\n  onShouldVirtualize?: (props: IListProps) => boolean;\n\n  /** Stores parent group's children. */\n  groups?: IGroup[];\n}\n\nexport interface IGroupedListSectionState {\n  isDropping?: boolean;\n  isSelected?: boolean;\n}\n\nconst DEFAULT_DROPPING_CSS_CLASS = 'is-dropping';\n\nexport class GroupedListSection extends BaseComponent<IGroupedListSectionProps, IGroupedListSectionState> {\n  private _root = createRef<HTMLDivElement>();\n  private _list = createRef<List>();\n\n  private _dragDropSubscription: IDisposable;\n\n  constructor(props: IGroupedListSectionProps) {\n    super(props);\n\n    const { selection, group } = props;\n\n    this.state = {\n      isDropping: false,\n      isSelected: (selection && group) ? selection.isRangeSelected(group.startIndex, group.count) : false\n    };\n  }\n\n  public componentDidMount(): void {\n    const { dragDropHelper, selection } = this.props;\n\n    if (dragDropHelper && this._root.current) {\n      this._dragDropSubscription = dragDropHelper.subscribe(this._root.current, this._events, this._getGroupDragDropOptions());\n    }\n\n    if (selection) {\n      this._events.on(selection, SELECTION_CHANGE, this._onSelectionChange);\n    }\n  }\n\n  public componentWillUnmount() {\n    if (this._dragDropSubscription) {\n      this._dragDropSubscription.dispose();\n    }\n  }\n\n  public componentDidUpdate(previousProps: IGroupedListSectionProps) {\n    if (this.props.group !== previousProps.group ||\n      this.props.groupIndex !== previousProps.groupIndex ||\n      this.props.dragDropHelper !== previousProps.dragDropHelper) {\n      if (this._dragDropSubscription) {\n        this._dragDropSubscription.dispose();\n        delete this._dragDropSubscription;\n      }\n\n      if (this.props.dragDropHelper && this._root.current) {\n        this._dragDropSubscription = this.props.dragDropHelper.subscribe(this._root.current, this._events, this._getGroupDragDropOptions());\n      }\n    }\n  }\n\n  public render(): JSX.Element {\n    const {\n      getGroupItemLimit,\n      group,\n      groupIndex,\n      headerProps,\n      showAllProps,\n      footerProps,\n      viewport,\n      selectionMode,\n      onRenderGroupHeader = this._onRenderGroupHeader,\n      onRenderGroupShowAll = this._onRenderGroupShowAll,\n      onRenderGroupFooter = this._onRenderGroupFooter,\n      onShouldVirtualize,\n      groups\n    } = this.props;\n    const { isSelected } = this.state;\n    const renderCount = group && getGroupItemLimit ? getGroupItemLimit(group) : Infinity;\n    const isShowAllVisible = group && !group.children && !group.isCollapsed && !group.isShowingAll &&\n      (group.count > renderCount || group.hasMoreData);\n    const hasNestedGroups = group && group.children && group.children.length > 0;\n\n    const dividerProps: IGroupDividerProps = {\n      group: group,\n      groupIndex: groupIndex,\n      groupLevel: group ? group.level : 0,\n      isSelected,\n      viewport: viewport,\n      selectionMode: selectionMode,\n      groups: groups\n    };\n    const groupHeaderProps: IGroupDividerProps = assign({}, headerProps, dividerProps);\n    const groupShowAllProps: IGroupDividerProps = assign({}, showAllProps, dividerProps);\n    const groupFooterProps: IGroupDividerProps = assign({}, footerProps, dividerProps);\n\n    return (\n      <div\n        ref={ this._root }\n        className={ css('ms-GroupedList-group', styles.group, this._getDroppingClassName()) }\n        role='presentation'\n      >\n        { onRenderGroupHeader(groupHeaderProps, this._onRenderGroupHeader) }\n        {\n          group && group.isCollapsed ?\n            null :\n            (\n              hasNestedGroups ?\n                (\n                  <List\n                    ref={ this._list }\n                    items={ group!.children }\n                    onRenderCell={ this._renderSubGroup }\n                    getItemCountForPage={ this._returnOne }\n                    onShouldVirtualize={ onShouldVirtualize }\n                  />\n                ) :\n                this._onRenderGroup(renderCount)\n            )\n        }\n        {\n          group && group.isCollapsed ?\n            null :\n            isShowAllVisible && onRenderGroupShowAll(groupShowAllProps, this._onRenderGroupShowAll)\n        }\n        { onRenderGroupFooter(groupFooterProps, this._onRenderGroupFooter) }\n      </div>\n    );\n  }\n\n  public forceUpdate() {\n    super.forceUpdate();\n    this.forceListUpdate();\n  }\n\n  public forceListUpdate() {\n    const { group } = this.props;\n\n    if (this._list.current) {\n      this._list.current.forceUpdate();\n\n      if (group && group.children && group.children.length > 0) {\n        const subGroupCount = group.children.length;\n\n        for (let i = 0; i < subGroupCount; i++) {\n          const subGroup = this._list.current.refs['subGroup_' + String(i)] as GroupedListSection;\n\n          if (subGroup) {\n            subGroup.forceListUpdate();\n          }\n        }\n      }\n    } else {\n      const subGroup = this.refs['subGroup_' + String(0)] as GroupedListSection;\n\n      if (subGroup) {\n        subGroup.forceListUpdate();\n      }\n    }\n  }\n\n  private _onRenderGroupHeader = (props: IGroupDividerProps): JSX.Element => {\n    return <GroupHeader { ...props } />;\n  }\n\n  private _onRenderGroupShowAll = (props: IGroupDividerProps): JSX.Element => {\n    return <GroupShowAll { ...props } />;\n  }\n\n  private _onRenderGroupFooter = (props: IGroupDividerProps): JSX.Element => {\n    return <GroupFooter { ...props } />;\n  }\n\n  private _onSelectionChange(): void {\n    const { group, selection } = this.props;\n    const isSelected = selection!.isRangeSelected(group!.startIndex, group!.count);\n\n    if (isSelected !== this.state.isSelected) {\n      this.setState({ isSelected });\n    }\n  }\n\n  private _onRenderGroupCell(onRenderCell: any, groupNestingDepth: number | undefined)\n    : (item: any, itemIndex: number | undefined) => React.ReactNode {\n    return (item: any, itemIndex: number | undefined): React.ReactNode => {\n      return onRenderCell(groupNestingDepth, item, itemIndex);\n    };\n  }\n\n  private _onRenderGroup(renderCount: number): JSX.Element {\n    const {\n      group,\n      items,\n      onRenderCell,\n      listProps,\n      groupNestingDepth,\n      onShouldVirtualize\n    } = this.props;\n    const count = group ? group.count : items.length;\n    const startIndex = group ? group.startIndex : 0;\n\n    return (\n      <List\n        items={ items }\n        onRenderCell={ this._onRenderGroupCell(onRenderCell, groupNestingDepth) }\n        ref={ this._list }\n        renderCount={ Math.min(count, renderCount) }\n        startIndex={ startIndex }\n        onShouldVirtualize={ onShouldVirtualize }\n        { ...listProps }\n      />\n    );\n  }\n\n  private _renderSubGroup = (subGroup: any, subGroupIndex: number): JSX.Element | null => {\n    const {\n      dragDropEvents,\n      dragDropHelper,\n      eventsToRegister,\n      getGroupItemLimit,\n      groupNestingDepth,\n      items,\n      headerProps,\n      showAllProps,\n      footerProps,\n      listProps,\n      onRenderCell,\n      selection,\n      selectionMode,\n      viewport,\n      onRenderGroupHeader,\n      onRenderGroupShowAll,\n      onRenderGroupFooter,\n      onShouldVirtualize,\n      group\n    } = this.props;\n    return (!subGroup || subGroup.count > 0) ? (\n      <GroupedListSection\n        ref={ 'subGroup_' + subGroupIndex }\n        key={ this._getGroupKey(subGroup, subGroupIndex) }\n        dragDropEvents={ dragDropEvents }\n        dragDropHelper={ dragDropHelper }\n        eventsToRegister={ eventsToRegister }\n        footerProps={ footerProps }\n        getGroupItemLimit={ getGroupItemLimit }\n        group={ subGroup }\n        groupIndex={ subGroupIndex }\n        groupNestingDepth={ groupNestingDepth }\n        headerProps={ headerProps }\n        items={ items }\n        listProps={ listProps }\n        onRenderCell={ onRenderCell }\n        selection={ selection }\n        selectionMode={ selectionMode }\n        showAllProps={ showAllProps }\n        viewport={ viewport }\n        onRenderGroupHeader={ onRenderGroupHeader }\n        onRenderGroupShowAll={ onRenderGroupShowAll }\n        onRenderGroupFooter={ onRenderGroupFooter }\n        onShouldVirtualize={ onShouldVirtualize }\n        groups={ group!.children }\n      />\n    ) : null;\n  }\n\n  private _returnOne(): number {\n    return 1;\n  }\n\n  private _getGroupKey(group: any, index: number): string {\n    return 'group-' + ((group && group.key) ? group.key : String(group.level) + String(index));\n  }\n\n  /**\n   * collect all the data we need to enable drag/drop for a group\n   */\n  private _getGroupDragDropOptions = (): IDragDropOptions => {\n    const { group, groupIndex, dragDropEvents, eventsToRegister } = this.props;\n    const options = {\n      eventMap: eventsToRegister,\n      selectionIndex: -1,\n      context: { data: group, index: groupIndex, isGroup: true },\n      canDrag: () => false, // cannot drag groups\n      canDrop: dragDropEvents!.canDrop,\n      updateDropState: this._updateDroppingState\n    };\n    return options as IDragDropOptions;\n  }\n\n  /**\n   * update groupIsDropping state based on the input value, which is used to change style during drag and drop\n   *\n   * @private\n   * @param {boolean} newValue (new isDropping state value)\n   * @param {DragEvent} event (the event trigger dropping state change which can be dragenter, dragleave etc)\n   */\n  private _updateDroppingState = (newIsDropping: boolean, event: DragEvent): void => {\n    const { isDropping } = this.state;\n    const { dragDropEvents } = this.props;\n\n    if (!isDropping) {\n      if (dragDropEvents && dragDropEvents.onDragLeave) {\n        dragDropEvents.onDragLeave!(event, undefined);\n      }\n    } else {\n      if (dragDropEvents && dragDropEvents.onDragEnter) {\n        dragDropEvents.onDragEnter(event, undefined);\n      }\n    }\n\n    if (isDropping !== newIsDropping) {\n      this.setState({ isDropping: newIsDropping });\n    }\n  }\n\n  /**\n   * get the correct css class to reflect the dropping state for a given group\n   *\n   * If the group is the current drop target, return the default dropping class name\n   * Otherwise, return '';\n   *\n   */\n  private _getDroppingClassName(): string {\n    let { isDropping } = this.state;\n    const { group } = this.props;\n\n    isDropping = !!(group && isDropping);\n\n    return css(\n      isDropping && DEFAULT_DROPPING_CSS_CLASS,\n      isDropping && styles.groupIsDropping\n    );\n  }\n}\n"]}