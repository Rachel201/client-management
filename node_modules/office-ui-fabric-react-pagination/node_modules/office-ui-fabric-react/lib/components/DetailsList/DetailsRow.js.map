{"version":3,"file":"DetailsRow.js","sourceRoot":"../src/","sources":["components/DetailsList/DetailsRow.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport {\n  BaseComponent,\n  IDisposable,\n  assign,\n  css,\n  shallowCompare,\n  getNativeProps,\n  divProperties,\n  createRef\n} from '../../Utilities';\nimport { IColumn, CheckboxVisibility } from './DetailsList.types';\nimport { DetailsRowCheck, IDetailsRowCheckProps } from './DetailsRowCheck';\nimport { GroupSpacer } from '../GroupedList/GroupSpacer';\nimport { DetailsRowFields, IDetailsRowFieldsProps } from './DetailsRowFields';\nimport { FocusZone, FocusZoneDirection, IFocusZone } from '../../FocusZone';\nimport { ISelection, SelectionMode, SELECTION_CHANGE } from '../../utilities/selection/interfaces';\nimport { CollapseAllVisibility } from '../../GroupedList';\nimport {\n  IDragDropHelper,\n  IDragDropEvents,\n  IDragDropOptions,\n} from './../../utilities/dragdrop/interfaces';\nimport { IViewport } from '../../utilities/decorators/withViewport';\nimport { AnimationClassNames } from '../../Styling';\nimport * as stylesImport from './DetailsRow.scss';\nconst styles: any = stylesImport;\nimport * as checkStylesImport from './DetailsRowCheck.scss';\nconst checkStyles: any = checkStylesImport;\n\nexport interface IDetailsRowProps extends React.Props<DetailsRow> {\n  componentRef?: () => void;\n  item: any;\n  itemIndex: number;\n  columns: IColumn[];\n  compact?: boolean;\n  selectionMode: SelectionMode;\n  selection: ISelection;\n  eventsToRegister?: { eventName: string, callback: (item?: any, index?: number, event?: any) => void }[];\n  onDidMount?: (row?: DetailsRow) => void;\n  onWillUnmount?: (row?: DetailsRow) => void;\n  onRenderCheck?: (props: IDetailsRowCheckProps) => JSX.Element;\n  onRenderItemColumn?: (item?: any, index?: number, column?: IColumn) => any;\n  dragDropEvents?: IDragDropEvents;\n  dragDropHelper?: IDragDropHelper;\n  groupNestingDepth?: number;\n  viewport?: IViewport;\n  checkboxVisibility?: CheckboxVisibility;\n  collapseAllVisibility?: CollapseAllVisibility;\n  getRowAriaLabel?: (item: any) => string;\n  getRowAriaDescribedBy?: (item: any) => string;\n  checkButtonAriaLabel?: string;\n  checkboxCellClassName?: string;\n  rowFieldsAs?: React.StatelessComponent<IDetailsRowFieldsProps> | React.ComponentClass<IDetailsRowFieldsProps>;\n  className?: string;\n  shimmer?: boolean;\n}\n\nexport interface IDetailsRowSelectionState {\n  isSelected: boolean;\n  isSelectionModal: boolean;\n}\n\nexport interface IDetailsRowState {\n  selectionState?: IDetailsRowSelectionState;\n  columnMeasureInfo?: {\n    index: number;\n    column: IColumn;\n    onMeasureDone: (measuredWidth: number) => void;\n  };\n  isDropping?: boolean;\n  groupNestingDepth?: number;\n}\n\nconst DEFAULT_DROPPING_CSS_CLASS = 'is-dropping';\n\nexport class DetailsRow extends BaseComponent<IDetailsRowProps, IDetailsRowState> {\n  private _root: HTMLElement | undefined;\n  private _cellMeasurer = createRef<HTMLSpanElement>();\n  private _focusZone = createRef<IFocusZone>();\n  private _droppingClassNames: string;\n  private _hasMounted: boolean;\n  private _dragDropSubscription: IDisposable;\n\n  constructor(props: IDetailsRowProps) {\n    super(props);\n\n    this.state = {\n      selectionState: this._getSelectionState(props),\n      columnMeasureInfo: undefined,\n      isDropping: false,\n      groupNestingDepth: props.groupNestingDepth\n    };\n\n    this._droppingClassNames = '';\n\n    this._updateDroppingState = this._updateDroppingState.bind(this);\n    this._onToggleSelection = this._onToggleSelection.bind(this);\n  }\n\n  public componentDidMount(): void {\n    const { dragDropHelper } = this.props;\n\n    if (dragDropHelper) {\n      this._dragDropSubscription = dragDropHelper.subscribe(this._root as HTMLElement, this._events, this._getRowDragDropOptions());\n    }\n\n    this._events.on(this.props.selection, SELECTION_CHANGE, this._onSelectionChanged);\n\n    if (this.props.onDidMount && this.props.item) {\n      // If the item appears later, we should wait for it before calling this method.\n      this._hasMounted = true;\n      this.props.onDidMount(this);\n    }\n  }\n\n  public componentDidUpdate(previousProps: IDetailsRowProps) {\n    const state = this.state;\n    const { item, onDidMount } = this.props;\n    const { columnMeasureInfo } = state;\n\n    if (this.props.itemIndex !== previousProps.itemIndex ||\n      this.props.item !== previousProps.item ||\n      this.props.dragDropHelper !== previousProps.dragDropHelper) {\n      if (this._dragDropSubscription) {\n        this._dragDropSubscription.dispose();\n        delete this._dragDropSubscription;\n      }\n\n      if (this.props.dragDropHelper) {\n        this._dragDropSubscription = this.props.dragDropHelper.subscribe(this._root as HTMLElement, this._events, this._getRowDragDropOptions());\n      }\n    }\n\n    if (columnMeasureInfo && columnMeasureInfo.index >= 0 && this._cellMeasurer.current) {\n      const newWidth = this._cellMeasurer.current.getBoundingClientRect().width;\n\n      columnMeasureInfo.onMeasureDone(newWidth);\n\n      this.setState({\n        columnMeasureInfo: undefined\n      });\n    }\n\n    if (item && onDidMount && !this._hasMounted) {\n      this._hasMounted = true;\n      onDidMount(this);\n    }\n  }\n\n  public componentWillUnmount(): void {\n    const { item, onWillUnmount } = this.props;\n\n    // Only call the onWillUnmount callback if we have an item.\n    if (onWillUnmount && item) {\n      onWillUnmount(this);\n    }\n\n    if (this._dragDropSubscription) {\n      this._dragDropSubscription.dispose();\n      delete this._dragDropSubscription;\n    }\n  }\n\n  public componentWillReceiveProps(newProps: IDetailsRowProps): void {\n    this.setState({\n      selectionState: this._getSelectionState(newProps),\n      groupNestingDepth: newProps.groupNestingDepth\n    });\n  }\n\n  public render(): JSX.Element {\n    const {\n      className,\n      columns,\n      dragDropEvents,\n      item,\n      itemIndex,\n      onRenderCheck = this._onRenderCheck,\n      onRenderItemColumn,\n      selectionMode,\n      viewport,\n      checkboxVisibility,\n      getRowAriaLabel,\n      getRowAriaDescribedBy,\n      checkButtonAriaLabel,\n      checkboxCellClassName,\n      /** Alias rowFieldsAs as RowFields and default to DetailsRowFields if rowFieldsAs does not exist */\n      rowFieldsAs: RowFields = DetailsRowFields,\n      selection,\n      shimmer,\n      compact\n    } = this.props;\n    const { columnMeasureInfo, isDropping, groupNestingDepth } = this.state;\n    const { isSelected = false, isSelectionModal = false } = this.state.selectionState as IDetailsRowSelectionState;\n    const isDraggable = Boolean(dragDropEvents && dragDropEvents.canDrag && dragDropEvents.canDrag(item));\n    const droppingClassName = isDropping ? (this._droppingClassNames ? this._droppingClassNames : DEFAULT_DROPPING_CSS_CLASS) : '';\n    const ariaLabel = getRowAriaLabel ? getRowAriaLabel(item) : undefined;\n    const ariaDescribedBy = getRowAriaDescribedBy ? getRowAriaDescribedBy(item) : undefined;\n    const canSelect = selection.canSelectItem!(item);\n    const isContentUnselectable = selectionMode === SelectionMode.multiple;\n    const showCheckbox = selectionMode !== SelectionMode.none && checkboxVisibility !== CheckboxVisibility.hidden;\n    const ariaSelected = (selectionMode === SelectionMode.none) ? undefined : isSelected;\n\n    const rowFields = (\n      <RowFields\n        columns={ columns }\n        item={ item }\n        itemIndex={ itemIndex }\n        columnStartIndex={ showCheckbox ? 1 : 0 }\n        onRenderItemColumn={ onRenderItemColumn }\n        shimmer={ shimmer }\n      />\n    );\n    // Rendering Shimmer Animation outside the focus zone\n    if (shimmer) {\n      return (\n        <div\n          className={ css(\n            showCheckbox && styles.shimmerLeftBorder,\n            !compact && styles.shimmerBottomBorder\n          ) }\n        >\n          { rowFields }\n        </div>\n      );\n    }\n\n    return (\n      <FocusZone\n        { ...getNativeProps(this.props, divProperties) }\n        direction={ FocusZoneDirection.horizontal }\n        ref={ this._onRootRef }\n        componentRef={ this._focusZone }\n        role='row'\n        aria-label={ ariaLabel }\n        ariaDescribedBy={ ariaDescribedBy }\n        className={ css(\n          'ms-DetailsRow',\n          className,\n          AnimationClassNames.fadeIn400,\n          styles.root,\n          checkStyles.owner,\n          droppingClassName,\n          {\n            [`is-contentUnselectable ${styles.rootIsContentUnselectable}`]: isContentUnselectable,\n            [`is-selected ${checkStyles.isSelected} ${styles.rootIsSelected}`]: isSelected,\n            [`${styles.anySelected} ${checkStyles.anySelected}`]: isSelectionModal,\n            [`is-check-visible ${checkStyles.isVisible}`]: checkboxVisibility === CheckboxVisibility.always\n          }) }\n        data-is-focusable={ true }\n        data-selection-index={ itemIndex }\n        data-item-index={ itemIndex }\n        aria-rowindex={ itemIndex + 1 }\n        data-is-draggable={ isDraggable }\n        draggable={ isDraggable }\n        data-automationid='DetailsRow'\n        style={ { minWidth: viewport ? viewport.width : 0 } }\n        aria-selected={ ariaSelected }\n        allowFocusRoot={ true }\n      >\n        { showCheckbox && (\n          <div\n            role='gridcell'\n            aria-colindex={ 1 }\n            data-selection-toggle={ true }\n            className={ css('ms-DetailsRow-cell', 'ms-DetailsRow-cellCheck', checkStyles.owner, styles.cell, styles.checkCell, checkboxCellClassName) }\n          >\n            { onRenderCheck({\n              selected: isSelected,\n              anySelected: isSelectionModal,\n              title: checkButtonAriaLabel,\n              canSelect: canSelect\n            }) }\n          </div>\n        ) }\n\n        { GroupSpacer({ count: groupNestingDepth! - (this.props.collapseAllVisibility === CollapseAllVisibility.hidden ? 1 : 0) }) }\n\n        { item && rowFields }\n        { columnMeasureInfo && (\n          <span\n            role='presentation'\n            className={ css('ms-DetailsRow-cellMeasurer ms-DetailsRow-cell', styles.cellMeasurer, styles.cell) }\n            ref={ this._cellMeasurer }\n          >\n            <RowFields\n              columns={ [columnMeasureInfo.column] }\n              item={ item }\n              itemIndex={ itemIndex }\n              columnStartIndex={ (showCheckbox ? 1 : 0) + columns.length }\n              onRenderItemColumn={ onRenderItemColumn }\n            />\n          </span>\n        ) }\n\n        <span\n          role='checkbox'\n          className={ css(styles.checkCover) }\n          aria-checked={ isSelected }\n          data-selection-toggle={ true }\n        />\n      </FocusZone>\n    );\n  }\n\n  /**\n   * measure cell at index. and call the call back with the measured cell width when finish measure\n   *\n   * @param {number} index (the cell index)\n   * @param {(width: number) => void} onMeasureDone (the call back function when finish measure)\n   */\n  public measureCell(index: number, onMeasureDone: (width: number) => void): void {\n    const column = assign({}, this.props.columns[index]) as IColumn;\n\n    column.minWidth = 0;\n    column.maxWidth = 999999;\n\n    delete column.calculatedWidth;\n\n    this.setState({\n      columnMeasureInfo: {\n        index,\n        column,\n        onMeasureDone\n      }\n    });\n  }\n\n  public focus(forceIntoFirstElement: boolean = false): boolean {\n    return !!this._focusZone.current && this._focusZone.current.focus(forceIntoFirstElement);\n  }\n\n  protected _onRenderCheck(props: IDetailsRowCheckProps) {\n    return <DetailsRowCheck { ...props } />;\n  }\n\n  private _getSelectionState(props: IDetailsRowProps): IDetailsRowSelectionState {\n    const { itemIndex, selection } = props;\n\n    return {\n      isSelected: selection.isIndexSelected(itemIndex),\n      isSelectionModal: !!selection.isModal && selection.isModal()\n    };\n  }\n\n  private _onSelectionChanged(): void {\n    const selectionState = this._getSelectionState(this.props);\n\n    if (!shallowCompare(selectionState, this.state.selectionState)) {\n      this.setState({\n        selectionState: selectionState\n      });\n    }\n  }\n\n  private _onToggleSelection(): void {\n    const { selection } = this.props;\n\n    selection.toggleIndexSelected(this.props.itemIndex);\n  }\n\n  private _onRootRef = (focusZone: FocusZone): void => {\n    if (focusZone) {\n      // Need to resolve the actual DOM node, not the component. The element itself will be used for drag/drop and focusing.\n      this._root = ReactDOM.findDOMNode(focusZone) as HTMLElement;\n    } else {\n      this._root = undefined;\n    }\n  }\n\n  private _getRowDragDropOptions(): IDragDropOptions {\n    const {\n      item,\n      itemIndex,\n      dragDropEvents,\n      eventsToRegister\n    } = this.props;\n    const options = {\n      eventMap: eventsToRegister,\n      selectionIndex: itemIndex,\n      context: { data: item, index: itemIndex },\n      canDrag: dragDropEvents!.canDrag,\n      canDrop: dragDropEvents!.canDrop,\n      onDragStart: dragDropEvents!.onDragStart,\n      updateDropState: this._updateDroppingState,\n      onDrop: dragDropEvents!.onDrop,\n      onDragEnd: dragDropEvents!.onDragEnd,\n    };\n\n    return options;\n  }\n\n  /**\n   * update isDropping state based on the input value, which is used to change style during drag and drop\n   *\n   * when change to true, that means drag enter. we will add default dropping class name\n   * or the custom dropping class name (return result from onDragEnter) to the root elemet.\n   *\n   * when change to false, that means drag leave. we will remove the dropping class name from root element.\n   *\n   * @private\n   * @param {boolean} newValue (new isDropping state value)\n   * @param {DragEvent} event (the event trigger dropping state change which can be dragenter, dragleave etc)\n   */\n  private _updateDroppingState(newValue: boolean, event: DragEvent): void {\n    const { selectionState, isDropping } = this.state;\n    const { dragDropEvents, item } = this.props;\n\n    if (!newValue) {\n      if (dragDropEvents!.onDragLeave) {\n        dragDropEvents!.onDragLeave!(item, event);\n      }\n    } else {\n      if (dragDropEvents!.onDragEnter) {\n        this._droppingClassNames = dragDropEvents!.onDragEnter!(item, event);\n      }\n    }\n\n    if (isDropping !== newValue) {\n      this.setState({ selectionState: selectionState, isDropping: newValue });\n    }\n  }\n}\n"]}