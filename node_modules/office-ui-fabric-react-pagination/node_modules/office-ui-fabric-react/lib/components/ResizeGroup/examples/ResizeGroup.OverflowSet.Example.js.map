{"version":3,"file":"ResizeGroup.OverflowSet.Example.js","sourceRoot":"../src/","sources":["components/ResizeGroup/examples/ResizeGroup.OverflowSet.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { BaseComponent } from 'office-ui-fabric-react/lib/Utilities';\nimport { DefaultButton } from 'office-ui-fabric-react/lib/Button';\nimport { ResizeGroup } from 'office-ui-fabric-react/lib/ResizeGroup';\nimport { OverflowSet } from '../../OverflowSet';\nimport { Checkbox } from 'office-ui-fabric-react/lib/Checkbox';\nimport { IContextualMenuItem } from 'office-ui-fabric-react/lib/ContextualMenu';\nimport { Dropdown, IDropdownOption } from 'office-ui-fabric-react/lib/Dropdown';\n\nimport * as stylesImport from './ResizeGroup.Example.scss';\nconst styles: any = stylesImport;\n\nexport interface IOverflowData {\n  primary: IContextualMenuItem[];\n  overflow: IContextualMenuItem[];\n  cacheKey?: string;\n}\n\nfunction generateData(count: number, cachingEnabled: boolean, checked: boolean): IOverflowData {\n  const icons = ['Add', 'Share', 'Upload'];\n  const dataItems = [];\n  let cacheKey = '';\n  for (let index = 0; index < count; index++) {\n    const item = {\n      key: `item${index}`,\n      name: `Item ${index}`,\n      icon: icons[index % icons.length],\n      checked: checked\n    };\n\n    cacheKey = cacheKey + item.key;\n    dataItems.push(item);\n  }\n\n  let result: IOverflowData = {\n    primary: dataItems,\n    overflow: [] as any[]\n  };\n\n  if (cachingEnabled) {\n    result = { ...result, cacheKey };\n  }\n\n  return result;\n}\n\nexport interface IResizeGroupOverflowSetExampleState {\n  short: boolean;\n  numberOfItems: number;\n  buttonsChecked: boolean;\n  cachingEnabled: boolean;\n  onGrowDataEnabled: boolean;\n}\n\nfunction computeCacheKey(primaryControls: IContextualMenuItem[]): string {\n  return primaryControls.reduce((acc, current) => acc + current.key, '');\n}\n\nexport class ResizeGroupOverflowSetExample extends BaseComponent<{}, IResizeGroupOverflowSetExampleState> {\n\n  constructor(props: {}) {\n    super(props);\n    this.state = {\n      short: false,\n      buttonsChecked: false,\n      cachingEnabled: false,\n      onGrowDataEnabled: false,\n      numberOfItems: 20\n    };\n  }\n\n  public render(): JSX.Element {\n    const { numberOfItems, cachingEnabled, buttonsChecked, short, onGrowDataEnabled } = this.state;\n    const dataToRender = generateData(numberOfItems, cachingEnabled, buttonsChecked);\n    return (\n      <div className={ short ? styles.resizeIsShort : 'notResized' }>\n        <ResizeGroup\n          role='tabpanel'\n          aria-label='Resize Group with an Overflow Set'\n          data={ dataToRender }\n          onReduceData={ this._onReduceData }\n          onGrowData={ onGrowDataEnabled ? this._onGrowData : undefined }\n          // tslint:disable-next-line:jsx-no-lambda\n          onRenderData={ (data) => {\n            return (\n              <OverflowSet\n                items={ data.primary }\n                overflowItems={ data.overflow.length ? data.overflow : null }\n                onRenderItem={ (item) => {\n                  return (\n                    <DefaultButton\n                      text={ item.name }\n                      iconProps={ { iconName: item.icon } }\n                      onClick={ item.onClick }\n                      checked={ item.checked }\n                    />\n                  );\n                } }\n                onRenderOverflowButton={ (overflowItems) => {\n                  return (\n                    <DefaultButton\n                      menuProps={ { items: overflowItems! } }\n                    />\n                  );\n                } }\n              />\n            );\n          } }\n        />\n        <div className={ styles.settingsGroup }>\n          <Checkbox label='Enable caching' onChange={ this._onCachingEnabledChanged } checked={ cachingEnabled } />\n          <Checkbox label='Set onGrowData' onChange={ this._onGrowDataEnabledChanged } checked={ onGrowDataEnabled } />\n          <Checkbox label='Buttons checked' onChange={ this._onButtonsCheckedChanged } checked={ buttonsChecked } />\n          <div className={ styles.itemCountDropdown } >\n            <Dropdown\n              label='Number of items to render'\n              selectedKey={ numberOfItems.toString() }\n              onChanged={ this._onNumberOfItemsChanged }\n              options={\n                [{ key: '20', text: '20' },\n                { key: '30', text: '30' },\n                { key: '40', text: '40' },\n                { key: '50', text: '50' },\n                { key: '75', text: '75' },\n                { key: '100', text: '100' },\n                { key: '200', text: '200' }] }\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  private _onReduceData = (currentData: any): any => {\n    if (currentData.primary.length === 0) {\n      return undefined;\n    }\n\n    const overflow = [...currentData.primary.slice(-1), ...currentData.overflow];\n    const primary = currentData.primary.slice(0, -1);\n\n    let cacheKey = undefined;\n    if (this.state.cachingEnabled) {\n      cacheKey = computeCacheKey(primary);\n    }\n    return { primary, overflow, cacheKey };\n  }\n\n  private _onGrowData = (currentData: any): any => {\n    if (currentData.overflow.length === 0) {\n      return undefined;\n    }\n\n    const overflow = currentData.overflow.slice(1);\n    const primary = [...currentData.primary, ...currentData.overflow.slice(0, 1)];\n\n    let cacheKey = undefined;\n    if (this.state.cachingEnabled) {\n      cacheKey = computeCacheKey(primary);\n    }\n    return { primary, overflow, cacheKey };\n  }\n\n  private _onCachingEnabledChanged = (_: React.FormEvent<HTMLElement | HTMLInputElement>, checked: boolean): void => {\n    this.setState({ cachingEnabled: checked });\n  }\n\n  private _onGrowDataEnabledChanged = (_: React.FormEvent<HTMLElement | HTMLInputElement>, checked: boolean): void => {\n    this.setState({ onGrowDataEnabled: checked });\n  }\n\n  private _onButtonsCheckedChanged = (_: React.FormEvent<HTMLElement | HTMLInputElement>, checked: boolean): void => {\n    this.setState({ buttonsChecked: checked });\n  }\n\n  private _onNumberOfItemsChanged = (option: IDropdownOption): void => {\n    this.setState({ numberOfItems: parseInt(option.text, 10) });\n  }\n}"]}