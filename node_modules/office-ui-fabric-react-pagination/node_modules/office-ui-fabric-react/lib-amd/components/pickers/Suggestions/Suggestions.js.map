{"version":3,"file":"Suggestions.js","sourceRoot":"../src/","sources":["components/pickers/Suggestions/Suggestions.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport {\n  BaseComponent,\n  css,\n  KeyCodes,\n  createRef\n} from '../../../Utilities';\nimport { CommandButton, IconButton, IButton } from '../../../Button';\nimport { Spinner } from '../../../Spinner';\nimport { ISuggestionItemProps, ISuggestionsProps } from './Suggestions.types';\nimport * as stylesImport from './Suggestions.scss';\nconst styles: any = stylesImport;\n\nexport enum SuggestionActionType {\n  none,\n  forceResolve,\n  searchMore,\n}\n\nexport interface ISuggestionsState {\n  selectedActionType: SuggestionActionType;\n}\n\nexport class SuggestionsItem<T> extends BaseComponent<ISuggestionItemProps<T>, {}> {\n  public render(): JSX.Element {\n    const {\n      suggestionModel,\n      RenderSuggestion,\n      onClick,\n      className,\n      onRemoveItem,\n      isSelectedOverride,\n      removeButtonAriaLabel\n    } = this.props;\n    return (\n      <div\n        className={ css(\n          'ms-Suggestions-item',\n          styles.suggestionsItem,\n          {\n            ['is-suggested ' + styles.suggestionsItemIsSuggested]: suggestionModel.selected || isSelectedOverride\n          },\n          className\n        ) }\n      >\n        <CommandButton\n          onClick={ onClick }\n          className={ css('ms-Suggestions-itemButton', styles.itemButton) }\n        >\n          { RenderSuggestion(suggestionModel.item, this.props) }\n        </CommandButton>\n        { this.props.showRemoveButton ? (\n          <IconButton\n            iconProps={ { iconName: 'Cancel', style: { fontSize: '12px' } } }\n            title={ removeButtonAriaLabel }\n            ariaLabel={ removeButtonAriaLabel }\n            onClick={ onRemoveItem }\n            className={ css('ms-Suggestions-closeButton', styles.closeButton) }\n          />) : (null)\n        }\n      </div>\n    );\n  }\n}\n\nexport class Suggestions<T> extends BaseComponent<ISuggestionsProps<T>, ISuggestionsState> {\n\n  protected _forceResolveButton = createRef<IButton>();\n  protected _searchForMoreButton = createRef<IButton>();\n  protected _selectedElement = createRef<HTMLDivElement>();\n  private SuggestionsItemOfProperType = SuggestionsItem as new (props: ISuggestionItemProps<T>) => SuggestionsItem<T>;\n  private activeSelectedElement: HTMLDivElement | null;\n  constructor(suggestionsProps: ISuggestionsProps<T>) {\n    super(suggestionsProps);\n    this.state = {\n      selectedActionType: SuggestionActionType.none,\n    };\n  }\n\n  public componentDidMount(): void {\n    this.scrollSelected();\n    this.activeSelectedElement = this._selectedElement ? this._selectedElement.current : null;\n  }\n\n  public componentDidUpdate(): void {\n    // Only scroll to selected element if the selected element has changed. Otherwise do nothing.\n    // This prevents some odd behavior where scrolling the active element out of view and clicking on a selected element\n    // will trigger a focus event and not give the clicked element the click.\n    if (this._selectedElement.current && this.activeSelectedElement !== this._selectedElement.current) {\n      this.scrollSelected();\n      this.activeSelectedElement = this._selectedElement.current;\n    }\n  }\n\n  public render(): JSX.Element {\n    const {\n      forceResolveText,\n      mostRecentlyUsedHeaderText,\n      searchForMoreText,\n      className,\n      moreSuggestionsAvailable,\n      noResultsFoundText,\n      suggestions,\n      isLoading,\n      isSearching,\n      loadingText,\n      onRenderNoResultFound,\n      searchingText,\n      isMostRecentlyUsedVisible,\n      resultsMaximumNumber,\n      resultsFooterFull,\n      resultsFooter,\n      isResultsFooterVisible = true,\n      suggestionsAvailableAlertText,\n      suggestionsHeaderText,\n    } = this.props;\n\n    const noResults = () => {\n      return noResultsFoundText ?\n        (\n          <div role='alert' className={ css('ms-Suggestions-none', styles.suggestionsNone) }>\n            { noResultsFoundText }\n          </div>\n        ) : null;\n    };\n    // MostRecently Used text should supercede the header text if it's there and available.\n    let headerText: string | undefined = suggestionsHeaderText;\n    if (isMostRecentlyUsedVisible && mostRecentlyUsedHeaderText) {\n      headerText = mostRecentlyUsedHeaderText;\n    }\n    let footerTitle: ((props: ISuggestionsProps<T>) => JSX.Element) | undefined = undefined;\n    if (isResultsFooterVisible) {\n      footerTitle = (suggestions.length >= (resultsMaximumNumber as number)) ? resultsFooterFull : resultsFooter;\n    }\n    const hasNoSuggestions = (!suggestions || !suggestions.length) && !isLoading;\n    return (\n      <div\n        className={ css(\n          'ms-Suggestions',\n          className ? className : '',\n          styles.root) }\n      >\n        { headerText ?\n          (<div className={ css('ms-Suggestions-title', styles.suggestionsTitle) }>\n            { headerText }\n          </div>) : (null) }\n        { forceResolveText && this._shouldShowForceResolve() && (\n          <CommandButton\n            componentRef={ this._forceResolveButton }\n            className={ css(\n              'ms-forceResolve-button',\n              styles.actionButton,\n              {\n                ['is-selected ' + styles.buttonSelected]:\n                  this.state.selectedActionType === SuggestionActionType.forceResolve\n              }) }\n            onClick={ this._forceResolve }\n          >\n            { forceResolveText }\n          </CommandButton>\n        ) }\n        { isLoading && (\n          <Spinner\n            className={ css('ms-Suggestions-spinner', styles.suggestionsSpinner) }\n            label={ loadingText }\n          />) }\n        { hasNoSuggestions ?\n          (onRenderNoResultFound ? onRenderNoResultFound(undefined, noResults) : noResults()) :\n          this._renderSuggestions()\n        }\n        { searchForMoreText && moreSuggestionsAvailable && (\n          <CommandButton\n            componentRef={ this._searchForMoreButton }\n            className={ css('ms-SearchMore-button',\n              styles.actionButton,\n              {\n                ['is-selected ' + styles.buttonSelected]:\n                  this.state.selectedActionType === SuggestionActionType.searchMore\n              }) }\n            iconProps={ { iconName: 'Search' } }\n            onClick={ this._getMoreResults }\n          >\n            { searchForMoreText }\n          </CommandButton>\n        ) }\n        { isSearching ?\n          (<Spinner\n            className={ css('ms-Suggestions-spinner', styles.suggestionsSpinner) }\n            label={ searchingText }\n          />) : (null)\n        }\n        {\n          footerTitle && !moreSuggestionsAvailable && !isMostRecentlyUsedVisible && !isSearching ?\n            (<div className={ css('ms-Suggestions-title', styles.suggestionsTitle) }>\n              { footerTitle(this.props) }\n            </div>) : (null)\n        }\n        {\n          (<span\n            role='alert'\n            aria-live='polite'\n            className={ css('ms-Suggestions-suggestionsAvailable', styles.suggestionsAvailable) }\n          >\n            { (!isLoading && !isSearching && suggestions && suggestions.length > 0 && suggestionsAvailableAlertText) ?\n              suggestionsAvailableAlertText : null\n            }\n          </span>)\n        }\n      </div>\n    );\n  }\n\n  /**\n   * Returns true if the event was handled, false otherwise\n   */\n  public tryHandleKeyDown = (keyCode: number, currentSuggestionIndex: number): boolean => {\n    let isEventHandled = false;\n    let newSelectedActionType = null;\n    const currentSelectedAction = this.state.selectedActionType;\n    const suggestionLength = this.props.suggestions.length;\n    if (keyCode === KeyCodes.down) {\n      switch (currentSelectedAction) {\n        case SuggestionActionType.forceResolve:\n          if (suggestionLength > 0) {\n            this._refocusOnSuggestions(keyCode);\n            newSelectedActionType = SuggestionActionType.none;\n          } else if (this._searchForMoreButton.current) {\n            newSelectedActionType = SuggestionActionType.searchMore;\n          } else {\n            newSelectedActionType = SuggestionActionType.forceResolve;\n          }\n          break;\n        case SuggestionActionType.searchMore:\n          if (this._forceResolveButton.current) {\n            newSelectedActionType = SuggestionActionType.forceResolve;\n          } else if (suggestionLength > 0) {\n            this._refocusOnSuggestions(keyCode);\n            newSelectedActionType = SuggestionActionType.none;\n          } else {\n            newSelectedActionType = SuggestionActionType.searchMore;\n          }\n          break;\n        case SuggestionActionType.none:\n          if (currentSuggestionIndex === -1 && this._forceResolveButton.current) {\n            newSelectedActionType = SuggestionActionType.forceResolve;\n          }\n          break;\n      }\n    } else if (keyCode === KeyCodes.up) {\n      switch (currentSelectedAction) {\n        case SuggestionActionType.forceResolve:\n          if (this._searchForMoreButton.current) {\n            newSelectedActionType = SuggestionActionType.searchMore;\n          } else if (suggestionLength > 0) {\n            this._refocusOnSuggestions(keyCode);\n            newSelectedActionType = SuggestionActionType.none;\n          }\n          break;\n        case SuggestionActionType.searchMore:\n          if (suggestionLength > 0) {\n            this._refocusOnSuggestions(keyCode);\n            newSelectedActionType = SuggestionActionType.none;\n          } else if (this._forceResolveButton.current) {\n            newSelectedActionType = SuggestionActionType.forceResolve;\n          }\n          break;\n        case SuggestionActionType.none:\n          if (currentSuggestionIndex === -1 && this._searchForMoreButton.current) {\n            newSelectedActionType = SuggestionActionType.searchMore;\n          }\n          break;\n      }\n    }\n\n    if (newSelectedActionType !== null) {\n      this.setState({ selectedActionType: newSelectedActionType });\n      isEventHandled = true;\n    }\n\n    return isEventHandled;\n  }\n\n  public hasSuggestedAction(): boolean {\n    return this._searchForMoreButton.current !== undefined || this._forceResolveButton.current !== undefined;\n  }\n\n  public hasSuggestedActionSelected(): boolean {\n    return (this.state.selectedActionType !== SuggestionActionType.none);\n  }\n\n  public executeSelectedAction(): void {\n    switch (this.state.selectedActionType) {\n      case SuggestionActionType.forceResolve:\n        this._forceResolve();\n        break;\n      case SuggestionActionType.searchMore:\n        this._getMoreResults();\n        break;\n    }\n  }\n\n  public focusAboveSuggestions(): void {\n    if (this._forceResolveButton.current) {\n      this.setState({ selectedActionType: SuggestionActionType.forceResolve });\n    } else if (this._searchForMoreButton.current) {\n      this.setState({ selectedActionType: SuggestionActionType.searchMore });\n    }\n  }\n\n  public focusBelowSuggestions(): void {\n    if (this._searchForMoreButton.current) {\n      this.setState({ selectedActionType: SuggestionActionType.searchMore });\n    } else if (this._forceResolveButton.current) {\n      this.setState({ selectedActionType: SuggestionActionType.forceResolve });\n    }\n  }\n\n  public focusSearchForMoreButton(): void {\n    if (this._searchForMoreButton.current) {\n      this._searchForMoreButton.current.focus();\n    }\n  }\n\n  // TODO get the element to scroll into view properly regardless of direction.\n  public scrollSelected(): void {\n    if (this._selectedElement.current && this._selectedElement.current.scrollIntoView !== undefined) {\n      this._selectedElement.current.scrollIntoView(false);\n    }\n  }\n\n  private _renderSuggestions(): JSX.Element | null {\n    const {\n      onRenderSuggestion,\n      removeSuggestionAriaLabel,\n      suggestionsItemClassName,\n      resultsMaximumNumber,\n      showRemoveButtons,\n      suggestionsContainerAriaLabel,\n      suggestionsListId,\n      suggestionsClassName\n    } = this.props;\n    let { suggestions } = this.props;\n    const TypedSuggestionsItem = this.SuggestionsItemOfProperType;\n\n    if (resultsMaximumNumber) {\n      suggestions = suggestions.slice(0, resultsMaximumNumber);\n    }\n\n    if (suggestions.length === 0) {\n      return null;\n    }\n\n    return (\n      <div\n        className={ css('ms-Suggestions-container', styles.suggestionsContainer, suggestionsClassName) }\n        id={ suggestionsListId }\n        role='listbox'\n        aria-label={ suggestionsContainerAriaLabel }\n      >\n        { suggestions.map((suggestion, index) =>\n          <div\n            ref={ suggestion.selected ? this._selectedElement : '' }\n            // tslint:disable-next-line:no-string-literal\n            key={ (suggestion.item as any)['key'] ? (suggestion.item as any)['key'] : index }\n            id={ 'sug-' + index }\n            aria-selected={ suggestion.selected }\n            role='option'\n            aria-label={ suggestion.ariaLabel }\n          >\n            <TypedSuggestionsItem\n              suggestionModel={ suggestion }\n              RenderSuggestion={ onRenderSuggestion as any }\n              onClick={ this._onClickTypedSuggestionsItem(suggestion.item, index) }\n              className={ suggestionsItemClassName }\n              showRemoveButton={ showRemoveButtons }\n              removeButtonAriaLabel={ removeSuggestionAriaLabel }\n              onRemoveItem={ this._onRemoveTypedSuggestionsItem(suggestion.item, index) }\n            />\n          </div>) }\n      </div>);\n  }\n\n  private _getMoreResults = (): void => {\n    if (this.props.onGetMoreResults) {\n      this.props.onGetMoreResults();\n    }\n  }\n\n  private _forceResolve = (): void => {\n    if (this.props.createGenericItem) {\n      this.props.createGenericItem();\n    }\n  }\n\n  private _shouldShowForceResolve = (): boolean => {\n    return this.props.showForceResolve ? this.props.showForceResolve() : false;\n  }\n\n  private _onClickTypedSuggestionsItem = (item: T, index: number): (ev: React.MouseEvent<HTMLElement>) => void => {\n    return (ev: React.MouseEvent<HTMLElement>): void => {\n      this.props.onSuggestionClick(ev, item, index);\n    };\n  }\n\n  private _refocusOnSuggestions = (keyCode: number): void => {\n    if (typeof this.props.refocusSuggestions === 'function') {\n      this.props.refocusSuggestions(keyCode);\n    }\n  }\n\n  private _onRemoveTypedSuggestionsItem = (item: T, index: number): (ev: React.MouseEvent<HTMLElement>) => void => {\n    return (ev: React.MouseEvent<HTMLElement>): void => {\n      const onSuggestionRemove = this.props.onSuggestionRemove!;\n      onSuggestionRemove(ev, item, index);\n      ev.stopPropagation();\n    };\n  }\n}\n"]}