{"version":3,"file":"SearchBox.base.js","sourceRoot":"../src/","sources":["components/SearchBox/SearchBox.base.tsx"],"names":[],"mappings":";AAAA,OAAO,KAAK,KAAK,MAAM,OAAO,CAAC;AAE/B,OAAO,EACL,aAAa,EACb,KAAK,EAEL,YAAY,EACZ,kBAAkB,EAClB,SAAS,EACV,MAAM,iBAAiB,CAAC;AAEzB,OAAO,EAAE,UAAU,EAAE,MAAM,cAAc,CAAC;AAC1C,OAAO,EAAE,IAAI,EAAE,MAAM,YAAY,CAAC;AAElC,IAAM,aAAa,GAAG,kBAAkB,EAA0C,CAAC;AASnF;IAAmC,yCAA+C;IAShF,uBAAmB,KAAsB;QAAzC,YACE,kBAAM,KAAK,CAAC,SAcb;QAnBO,kBAAY,GAAG,SAAS,EAAkB,CAAC;QAC3C,mBAAa,GAAG,SAAS,EAAoB,CAAC;QA+H9C,mBAAa,GAAG;YACtB,IAAM,YAAY,GAAG,KAAI,CAAC,aAAa,CAAC,KAAK,CAAC;YAC9C,IAAI,YAAY,EAAE;gBAChB,KAAI,CAAC,KAAK,EAAE,CAAC;gBACb,YAAY,CAAC,cAAc,GAAG,YAAY,CAAC,YAAY,GAAG,CAAC,CAAC;aAC7D;QACH,CAAC,CAAA;QAEO,qBAAe,GAAG,UAAC,EAAiC;YAC1D,KAAI,CAAC,QAAQ,CAAC;gBACZ,QAAQ,EAAE,IAAI;aACf,CAAC,CAAC;YAEH,KAAI,CAAC,OAAO,CAAC,EAAE,CAAC,KAAI,CAAC,YAAY,CAAC,OAAO,EAAE,MAAM,EAAE,KAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;YAEvE,IAAI,KAAI,CAAC,KAAK,CAAC,OAAO,EAAE;gBACtB,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,EAAwC,CAAC,CAAC;aAC9D;QACH,CAAC,CAAA;QAEO,mBAAa,GAAG,UAAC,EAA2D;YAC1E,IAAA,+CAAgB,CAAgB;YAExC,IAAI,gBAAgB,IAAI,gBAAgB,CAAC,OAAO,EAAE;gBAChD,gBAAgB,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;aAC9B;YAED,IAAI,CAAC,EAAE,CAAC,gBAAgB,EAAE;gBACxB,KAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;aACnB;QACH,CAAC,CAAA;QAEO,gBAAU,GAAG,UAAC,EAAyC;YAE7D,QAAQ,EAAE,CAAC,KAAK,EAAE;gBAEhB;oBACE,KAAI,CAAC,KAAK,CAAC,QAAQ,IAAI,KAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;oBAC/C,IAAI,CAAC,EAAE,CAAC,gBAAgB,EAAE;wBACxB,KAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;qBACnB;oBACD,MAAM;gBAER;oBACE,IAAI,KAAI,CAAC,KAAK,CAAC,QAAQ,IAAI,KAAI,CAAC,KAAK,CAAC,KAAM,CAAC,MAAM,GAAG,CAAC,EAAE;wBACvD,KAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,KAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;qBACvC;oBACD,MAAM;gBAER;oBACE,KAAI,CAAC,KAAK,CAAC,SAAS,IAAI,KAAI,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;oBACjD,IAAI,CAAC,EAAE,CAAC,gBAAgB,EAAE;wBACxB,OAAO;qBACR;aACJ;YAED,qDAAqD;YACrD,kEAAkE;YAClE,EAAE,CAAC,cAAc,EAAE,CAAC;YACpB,EAAE,CAAC,eAAe,EAAE,CAAC;QACvB,CAAC,CAAA;QAEO,aAAO,GAAG,UAAC,EAAsC;YACvD,KAAI,CAAC,OAAO,CAAC,GAAG,CAAC,KAAI,CAAC,YAAY,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;YACpD,KAAI,CAAC,QAAQ,CAAC;gBACZ,QAAQ,EAAE,KAAK;aAChB,CAAC,CAAC;YAEH,IAAI,KAAI,CAAC,KAAK,CAAC,MAAM,EAAE;gBACrB,KAAI,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;aACvB;QACH,CAAC,CAAA;QAEO,oBAAc,GAAG,UAAC,EAAuC;YAC/D,IAAM,KAAK,GAAG,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC;YAE9B,IAAI,KAAK,KAAK,KAAI,CAAC,YAAY,EAAE;gBAC/B,OAAO;aACR;YACD,KAAI,CAAC,YAAY,GAAG,KAAK,CAAC;YAE1B,KAAI,CAAC,QAAQ,CAAC,EAAE,KAAK,OAAA,EAAE,CAAC,CAAC;YACzB,KAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAC5B,CAAC,CAAA;QA5MC,KAAI,CAAC,iBAAiB,CAAC;YACrB,WAAW,EAAE,aAAa;YAC1B,cAAc,EAAE,OAAO;SACxB,CAAC,CAAC;QAEH,KAAI,CAAC,YAAY,GAAG,KAAK,CAAC,KAAK,IAAI,EAAE,CAAC;QAEtC,KAAI,CAAC,KAAK,GAAG;YACX,KAAK,EAAE,KAAI,CAAC,YAAY;YACxB,QAAQ,EAAE,KAAK;YACf,EAAE,EAAE,KAAK,CAAC,WAAW,CAAC;SACvB,CAAC;;IACJ,CAAC;IAEM,iDAAyB,GAAhC,UAAiC,QAAyB;QACxD,IAAI,QAAQ,CAAC,KAAK,KAAK,SAAS,EAAE;YAChC,IAAI,CAAC,YAAY,GAAG,QAAQ,CAAC,KAAK,CAAC;YACnC,IAAI,CAAC,QAAQ,CAAC;gBACZ,KAAK,EAAE,QAAQ,CAAC,KAAK;aACtB,CAAC,CAAC;SACJ;IACH,CAAC;IAEM,8BAAM,GAAb;QACQ,IAAA,eAWQ,EAVZ,wBAAS,EACT,4BAAW,EACX,wBAAS,EACT,sBAAQ,EACR,0BAAU,EACV,wBAAS,EACT,wBAAS,EACT,gBAAK,EACL,sCAAgB,EAChB,sCAAgB,CACH;QACT,IAAA,eAAoC,EAAlC,gBAAK,EAAE,sBAAQ,EAAE,UAAE,CAAgB;QAC3C,IAAM,gBAAgB,GAAG,SAAS,KAAK,SAAS,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,SAAS,CAAC;QAE3E,IAAM,UAAU,GAAG,aAAa,CAAC,SAAU,EAAE;YAC3C,KAAK,EAAE,KAAM;YACb,SAAS,WAAA;YACT,UAAU,YAAA;YACV,QAAQ,UAAA;YACR,QAAQ,UAAA;YACR,QAAQ,EAAE,KAAM,CAAC,MAAM,GAAG,CAAC;YAC3B,gBAAgB,kBAAA;SACjB,CAAC,CAAC;QAEH,OAAO,CACL,6BACE,GAAG,EAAG,IAAI,CAAC,YAAY,EACvB,SAAS,EAAG,UAAU,CAAC,IAAI,EAC3B,cAAc,EAAG,IAAI,CAAC,eAAe;YAErC,6BACE,SAAS,EAAG,UAAU,CAAC,aAAa,EACpC,OAAO,EAAG,IAAI,CAAC,aAAa;gBAE5B,oBAAC,IAAI,IACH,SAAS,EAAG,UAAU,CAAC,IAAI,EAC3B,QAAQ,EAAC,QAAQ,GACjB,CACE;YACN,+BACE,EAAE,EAAG,EAAE,EACP,SAAS,EAAG,UAAU,CAAC,KAAK,EAC5B,WAAW,EAAG,gBAAgB,EAC9B,QAAQ,EAAG,IAAI,CAAC,cAAc,EAC9B,OAAO,EAAG,IAAI,CAAC,cAAc,EAC7B,SAAS,EAAG,IAAI,CAAC,UAAU,EAC3B,KAAK,EAAG,KAAK,EACb,QAAQ,EAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,gBACjB,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,WAAW,EAChD,GAAG,EAAG,IAAI,CAAC,aAAa,GACxB;YACA,KAAM,CAAC,MAAM,GAAG,CAAC;gBACjB,6BAAK,SAAS,EAAG,UAAU,CAAC,WAAW;oBACrC,oBAAC,UAAU,qBACT,MAAM,EAAG,EAAE,IAAI,EAAE,EAAE,MAAM,EAAE,MAAM,EAAE,EAAE,IAAI,EAAE,EAAE,QAAQ,EAAE,MAAM,EAAE,EAAE,EACjE,SAAS,EAAG,EAAE,QAAQ,EAAE,OAAO,EAAE,IAC5B,gBAAgB,IACrB,OAAO,EAAG,IAAI,CAAC,aAAa,IAC5B,CACE,CAEJ,CACP,CAAC;IACJ,CAAC;IAED;;OAEG;IACI,6BAAK,GAAZ;QACE,IAAI,IAAI,CAAC,aAAa,CAAC,OAAO,EAAE;YAC9B,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;SACpC;IACH,CAAC;IAED;;OAEG;IACI,gCAAQ,GAAf;QACE,OAAO,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC;IAC/B,CAAC;IAEO,gCAAQ,GAAhB,UAAiB,EAA8F;QAC7G,IAAI,CAAC,KAAK,CAAC,OAAO,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;QAC7C,IAAI,CAAC,EAAE,CAAC,gBAAgB,EAAE;YACxB,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;YACvB,IAAI,CAAC,QAAQ,CAAC;gBACZ,KAAK,EAAE,EAAE;aACV,CAAC,CAAC;YACH,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;YACvB,EAAE,CAAC,eAAe,EAAE,CAAC;YACrB,EAAE,CAAC,cAAc,EAAE,CAAC;YAEpB,IAAI,CAAC,KAAK,EAAE,CAAC;SACd;IACH,CAAC;IAuFO,qCAAa,GAArB,UAAsB,QAAgB;QAC9B,IAAA,eAAoC,EAAlC,sBAAQ,EAAE,wBAAS,CAAgB;QAE3C,2BAA2B;QAC3B,IAAI,SAAS,EAAE;YACb,SAAS,CAAC,QAAQ,CAAC,CAAC;SACrB;QAED,IAAI,QAAQ,EAAE;YACZ,QAAQ,CAAC,QAAQ,CAAC,CAAC;SACpB;IACH,CAAC;IApOa,0BAAY,GAAoB;QAC5C,gBAAgB,EAAE,KAAK;KACxB,CAAC;IAHS,aAAa;QADzB,YAAY,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,CAAC;OACxB,aAAa,CAsOzB;IAAD,oBAAC;CAAA,AAtOD,CAAmC,aAAa,GAsO/C;SAtOY,aAAa","sourcesContent":["import * as React from 'react';\nimport { ISearchBoxProps, ISearchBoxStyleProps, ISearchBoxStyles } from './SearchBox.types';\nimport {\n  BaseComponent,\n  getId,\n  KeyCodes,\n  customizable,\n  classNamesFunction,\n  createRef\n} from '../../Utilities';\n\nimport { IconButton } from '../../Button';\nimport { Icon } from '../../Icon';\n\nconst getClassNames = classNamesFunction<ISearchBoxStyleProps, ISearchBoxStyles>();\n\nexport interface ISearchBoxState {\n  value?: string;\n  hasFocus?: boolean;\n  id?: string;\n}\n\n@customizable('SearchBox', ['theme'])\nexport class SearchBoxBase extends BaseComponent<ISearchBoxProps, ISearchBoxState> {\n  public static defaultProps: ISearchBoxProps = {\n    disableAnimation: false\n  };\n\n  private _rootElement = createRef<HTMLDivElement>();\n  private _inputElement = createRef<HTMLInputElement>();\n  private _latestValue: string;\n\n  public constructor(props: ISearchBoxProps) {\n    super(props);\n\n    this._warnDeprecations({\n      'labelText': 'placeholder',\n      'defaultValue': 'value'\n    });\n\n    this._latestValue = props.value || '';\n\n    this.state = {\n      value: this._latestValue,\n      hasFocus: false,\n      id: getId('SearchBox')\n    };\n  }\n\n  public componentWillReceiveProps(newProps: ISearchBoxProps): void {\n    if (newProps.value !== undefined) {\n      this._latestValue = newProps.value;\n      this.setState({\n        value: newProps.value\n      });\n    }\n  }\n\n  public render() {\n    const {\n      ariaLabel,\n      placeholder,\n      className,\n      disabled,\n      underlined,\n      getStyles,\n      labelText,\n      theme,\n      clearButtonProps,\n      disableAnimation\n    } = this.props;\n    const { value, hasFocus, id } = this.state;\n    const placeholderValue = labelText === undefined ? placeholder : labelText;\n\n    const classNames = getClassNames(getStyles!, {\n      theme: theme!,\n      className,\n      underlined,\n      hasFocus,\n      disabled,\n      hasInput: value!.length > 0,\n      disableAnimation\n    });\n\n    return (\n      <div\n        ref={ this._rootElement }\n        className={ classNames.root }\n        onFocusCapture={ this._onFocusCapture }\n      >\n        <div\n          className={ classNames.iconContainer }\n          onClick={ this._onClickFocus }\n        >\n          <Icon\n            className={ classNames.icon }\n            iconName='Search'\n          />\n        </div>\n        <input\n          id={ id }\n          className={ classNames.field }\n          placeholder={ placeholderValue }\n          onChange={ this._onInputChange }\n          onInput={ this._onInputChange }\n          onKeyDown={ this._onKeyDown }\n          value={ value }\n          disabled={ this.props.disabled }\n          aria-label={ ariaLabel ? ariaLabel : placeholder }\n          ref={ this._inputElement }\n        />\n        { value!.length > 0 &&\n          <div className={ classNames.clearButton }>\n            <IconButton\n              styles={ { root: { height: 'auto' }, icon: { fontSize: '12px' } } }\n              iconProps={ { iconName: 'Clear' } }\n              { ...clearButtonProps }\n              onClick={ this._onClearClick }\n            />\n          </div>\n        }\n      </div>\n    );\n  }\n\n  /**\n   * Sets focus to the search box input field\n   */\n  public focus() {\n    if (this._inputElement.current) {\n      this._inputElement.current.focus();\n    }\n  }\n\n  /**\n   * Returns whether or not the SearchBox has focus\n   */\n  public hasFocus(): boolean {\n    return !!this.state.hasFocus;\n  }\n\n  private _onClear(ev: React.MouseEvent<HTMLAnchorElement | HTMLButtonElement> | React.KeyboardEvent<HTMLElement>) {\n    this.props.onClear && this.props.onClear(ev);\n    if (!ev.defaultPrevented) {\n      this._latestValue = '';\n      this.setState({\n        value: ''\n      });\n      this._callOnChange('');\n      ev.stopPropagation();\n      ev.preventDefault();\n\n      this.focus();\n    }\n  }\n\n  private _onClickFocus = () => {\n    const inputElement = this._inputElement.value;\n    if (inputElement) {\n      this.focus();\n      inputElement.selectionStart = inputElement.selectionEnd = 0;\n    }\n  }\n\n  private _onFocusCapture = (ev: React.FocusEvent<HTMLElement>) => {\n    this.setState({\n      hasFocus: true\n    });\n\n    this._events.on(this._rootElement.current, 'blur', this._onBlur, true);\n\n    if (this.props.onFocus) {\n      this.props.onFocus(ev as React.FocusEvent<HTMLInputElement>);\n    }\n  }\n\n  private _onClearClick = (ev: React.MouseEvent<HTMLAnchorElement | HTMLButtonElement>) => {\n    const { clearButtonProps } = this.props;\n\n    if (clearButtonProps && clearButtonProps.onClick) {\n      clearButtonProps.onClick(ev);\n    }\n\n    if (!ev.defaultPrevented) {\n      this._onClear(ev);\n    }\n  }\n\n  private _onKeyDown = (ev: React.KeyboardEvent<HTMLInputElement>) => {\n\n    switch (ev.which) {\n\n      case KeyCodes.escape:\n        this.props.onEscape && this.props.onEscape(ev);\n        if (!ev.defaultPrevented) {\n          this._onClear(ev);\n        }\n        break;\n\n      case KeyCodes.enter:\n        if (this.props.onSearch && this.state.value!.length > 0) {\n          this.props.onSearch(this.state.value);\n        }\n        break;\n\n      default:\n        this.props.onKeyDown && this.props.onKeyDown(ev);\n        if (!ev.defaultPrevented) {\n          return;\n        }\n    }\n\n    // We only get here if the keypress has been handled,\n    // or preventDefault was called in case of default keyDown handler\n    ev.preventDefault();\n    ev.stopPropagation();\n  }\n\n  private _onBlur = (ev: React.FocusEvent<HTMLInputElement>): void => {\n    this._events.off(this._rootElement.current, 'blur');\n    this.setState({\n      hasFocus: false\n    });\n\n    if (this.props.onBlur) {\n      this.props.onBlur(ev);\n    }\n  }\n\n  private _onInputChange = (ev: React.ChangeEvent<HTMLInputElement>) => {\n    const value = ev.target.value;\n\n    if (value === this._latestValue) {\n      return;\n    }\n    this._latestValue = value;\n\n    this.setState({ value });\n    this._callOnChange(value);\n  }\n\n  private _callOnChange(newValue: string): void {\n    const { onChange, onChanged } = this.props;\n\n    // Call @deprecated method.\n    if (onChanged) {\n      onChanged(newValue);\n    }\n\n    if (onChange) {\n      onChange(newValue);\n    }\n  }\n}\n"]}