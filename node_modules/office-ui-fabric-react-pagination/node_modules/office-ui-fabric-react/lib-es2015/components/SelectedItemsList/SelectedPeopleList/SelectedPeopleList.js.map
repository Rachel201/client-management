{"version":3,"file":"SelectedPeopleList.js","sourceRoot":"../src/","sources":["components/SelectedItemsList/SelectedPeopleList/SelectedPeopleList.tsx"],"names":[],"mappings":"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","sourcesContent":["/* tslint:disable */\nimport * as React from 'react';\n/* tslint:enable */\nimport { BaseSelectedItemsList } from '../BaseSelectedItemsList';\nimport { IBaseSelectedItemsListProps, ISelectedItemProps } from '../BaseSelectedItemsList.types';\nimport { IPersonaProps } from '../../../Persona';\nimport { ExtendedSelectedItem } from './Items/ExtendedSelectedItem';\nimport { SelectedItemWithContextMenu } from './Items/SelectedItemWithContextMenu';\nimport { IRenderFunction } from '../../../Utilities';\nimport { IContextualMenuItem } from '../../../ContextualMenu';\nimport { IBaseFloatingPickerProps } from '../../../FloatingPicker';\nimport { EditingItem } from './Items/EditingItem';\n\nexport interface IExtendedPersonaProps extends IPersonaProps {\n  isValid: boolean;\n  blockRecipientRemoval?: boolean;\n  shouldBlockSelection?: boolean;\n  canExpand?: boolean;\n  isEditing?: boolean;\n}\n\nexport interface ISelectedPeopleItemProps extends ISelectedItemProps<IExtendedPersonaProps> {\n  onExpandItem?: () => void;\n  renderPersonaCoin?: IRenderFunction<IPersonaProps>;\n  renderPrimaryText?: IRenderFunction<IPersonaProps>;\n}\n\nexport interface ISelectedPeopleProps extends IBaseSelectedItemsListProps<IExtendedPersonaProps> {\n  onExpandGroup?: (item: IExtendedPersonaProps) => void;\n  removeMenuItemText?: string;\n  copyMenuItemText?: string;\n  editMenuItemText?: string;\n  getEditingItemText?: (item: IExtendedPersonaProps) => string;\n  onRenderFloatingPicker?: (props: IBaseFloatingPickerProps<IPersonaProps>) => JSX.Element;\n  floatingPickerProps?: IBaseFloatingPickerProps<IPersonaProps>;\n}\n\nexport class BasePeopleSelectedItemsList extends BaseSelectedItemsList<IExtendedPersonaProps, ISelectedPeopleProps> {\n}\n\n/**\n * Standard People Picker.\n */\nexport class SelectedPeopleList extends BasePeopleSelectedItemsList {\n\n  // tslint:disable-next-line:no-any\n  public static defaultProps: any = {\n    onRenderItem: (props: ISelectedPeopleItemProps) => <ExtendedSelectedItem { ...props } />,\n  };\n\n  public replaceItem = (itemToReplace: IExtendedPersonaProps, itemsToReplaceWith: IExtendedPersonaProps[]): void => {\n    const { items } = this.state;\n    const index: number = items.indexOf(itemToReplace);\n    if (index > -1) {\n      const newItems = items.slice(0, index).concat(itemsToReplaceWith).concat(items.slice(index + 1));\n      this.updateItems(newItems);\n    }\n  }\n\n  protected renderItems = (): JSX.Element[] => {\n    const { items } = this.state;\n    // tslint:disable-next-line:no-any\n    return items.map((item: any, index: number) => this._renderItem(item, index));\n  }\n\n  // tslint:disable-next-line:no-any\n  private _renderItem(item: any, index: number): JSX.Element {\n    const { removeButtonAriaLabel } = this.props;\n    const props = {\n      item,\n      index,\n      key: item.key ? item.key : index,\n      selected: this.selection.isIndexSelected(index),\n      onRemoveItem: () => this.removeItem(item),\n      onItemChange: this.onItemChange,\n      removeButtonAriaLabel: removeButtonAriaLabel,\n      onCopyItem: (itemToCopy: IExtendedPersonaProps) => this.copyItems([itemToCopy]),\n      onExpandItem: this.props.onExpandGroup ? () => (this.props.onExpandGroup as (item: IExtendedPersonaProps) => void)(item) : undefined,\n      menuItems: this._createMenuItems(item),\n    };\n\n    if ((item as IExtendedPersonaProps).isEditing) {\n      return (\n        <EditingItem\n          { ...props }\n          onRenderFloatingPicker={ this.props.onRenderFloatingPicker }\n          floatingPickerProps={ this.props.floatingPickerProps }\n          onEditingComplete={ this._completeEditing }\n          getEditingItemText={ this.props.getEditingItemText }\n        />\n      );\n    } else {\n      const onRenderItem = this.props.onRenderItem as (props: ISelectedPeopleItemProps) => JSX.Element;\n      const renderedItem = onRenderItem(props);\n      return (\n        props.menuItems.length > 0 ?\n          (\n            <SelectedItemWithContextMenu\n              renderedItem={ renderedItem }\n              beginEditing={ this._beginEditing }\n              menuItems={ this._createMenuItems(props.item) }\n              item={ props.item }\n            />\n          )\n          : renderedItem\n      );\n    }\n  }\n\n  private _beginEditing = (item: IExtendedPersonaProps): void => {\n    item.isEditing = true;\n    this.forceUpdate();\n  }\n\n  // tslint:disable-next-line:no-any\n  private _completeEditing = (oldItem: any, newItem: any): void => {\n    oldItem.isEditing = false;\n    this.replaceItem(oldItem, newItem);\n  }\n\n  // tslint:disable-next-line:no-any\n  private _createMenuItems(item: any): IContextualMenuItem[] {\n    const menuItems: IContextualMenuItem[] = [];\n\n    if (this.props.editMenuItemText && this.props.getEditingItemText) {\n      menuItems.push({\n        key: 'Edit',\n        name: this.props.editMenuItemText,\n        onClick: (ev: React.MouseEvent<HTMLElement>, menuItem: IContextualMenuItem) => {\n          this._beginEditing(menuItem.data);\n        },\n        data: item,\n      });\n    }\n\n    if (this.props.removeMenuItemText) {\n      menuItems.push(\n        {\n          key: 'Remove',\n          name: this.props.removeMenuItemText,\n          onClick: (ev: React.MouseEvent<HTMLElement>, menuItem: IContextualMenuItem) => {\n            this.removeItem(menuItem.data as ISelectedItemProps<IExtendedPersonaProps>);\n          },\n          data: item,\n        });\n    }\n\n    if (this.props.copyMenuItemText) {\n      menuItems.push({\n        key: 'Copy',\n        name: this.props.copyMenuItemText,\n        onClick: (ev: React.MouseEvent<HTMLElement>, menuItem: IContextualMenuItem) => {\n          if (this.props.onCopyItems) {\n            (this.copyItems as (items: IExtendedPersonaProps[]) => void)([menuItem.data] as IExtendedPersonaProps[]);\n          }\n        },\n        data: item,\n      });\n    }\n\n    return menuItems;\n  }\n}"]}