{"version":3,"file":"FloatingPeoplePicker.Basic.Example.js","sourceRoot":"../src/","sources":["components/FloatingPicker/PeoplePicker/examples/FloatingPeoplePicker.Basic.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["/* tslint:disable */\nimport * as React from 'react';\n/* tslint:enable */\nimport {\n  BaseComponent,\n  assign\n} from 'office-ui-fabric-react/lib/Utilities';\nimport { IPersonaProps } from 'office-ui-fabric-react/lib/Persona';\nimport { SuggestionsStore } from '../../Suggestions/SuggestionsStore';\nimport { IBaseFloatingPicker, IBaseFloatingPickerSuggestionProps, FloatingPeoplePicker } from 'office-ui-fabric-react/lib/FloatingPicker';\nimport { IPersonaWithMenu } from 'office-ui-fabric-react/lib/components/pickers/PeoplePicker/PeoplePickerItems/PeoplePickerItem.types';\nimport { people, mru } from 'office-ui-fabric-react/lib/ExtendedPicker';\nimport { SearchBox } from 'office-ui-fabric-react/lib/SearchBox';\nimport './FloatingPeoplePicker.Basic.Example.scss';\n\nexport interface IPeoplePickerExampleState {\n  currentPicker?: number | string;\n  peopleList: IPersonaProps[];\n  mostRecentlyUsed: IPersonaProps[];\n  currentSelectedItems?: IPersonaProps[];\n  searchValue: string;\n}\n\nexport class FloatingPeoplePickerTypesExample extends BaseComponent<{}, IPeoplePickerExampleState> {\n  private _picker: IBaseFloatingPicker;\n  private _inputElement: HTMLInputElement;\n\n  constructor(props: {}) {\n    super(props);\n    const peopleList: IPersonaWithMenu[] = [];\n    people.forEach((persona: IPersonaProps) => {\n      const target: IPersonaWithMenu = {};\n\n      assign(target, persona);\n      peopleList.push(target);\n    });\n\n    this.state = {\n      peopleList: peopleList,\n      mostRecentlyUsed: mru,\n      currentSelectedItems: [],\n      searchValue: ''\n    };\n  }\n\n  public render(): JSX.Element {\n    return (\n      <div>\n        <div className='ms-SearchBoxSmallExample' ref={ this._setInputElementRef }>\n          <SearchBox\n            placeholder={ 'Search a person' }\n            onChange={ this._onSearchChange }\n            value={ this.state.searchValue }\n            onFocus={ this._onFocus }\n          />\n        </div>\n        { this._renderFloatingPicker() }\n      </div>\n    );\n  }\n\n  private _onFocus = (): void => {\n    if (this._picker) {\n      this._picker.showPicker();\n    }\n  }\n\n  private _setInputElementRef = (ref: HTMLDivElement) => {\n    if (ref && ref.getElementsByClassName('ms-SearchBox-field').length > 0) {\n      this._inputElement = ref.getElementsByClassName('ms-SearchBox-field')[0] as HTMLInputElement;\n    }\n  }\n\n  private _renderFloatingPicker(): JSX.Element {\n    const suggestionProps: IBaseFloatingPickerSuggestionProps = {\n      footerItemsProps: [{\n        renderItem: () => { return (<div>Showing { this._picker.suggestions.length } results</div>); },\n        shouldShow: () => {\n          return this._picker.suggestions.length > 0;\n        }\n      }],\n    };\n\n    return (\n      <FloatingPeoplePicker\n        suggestionsStore={ new SuggestionsStore<IPersonaProps>() }\n        onResolveSuggestions={ this._onFilterChanged }\n        getTextFromItem={ this._getTextFromItem }\n        pickerSuggestionsProps={ suggestionProps }\n        key={ 'normal' }\n        onRemoveSuggestion={ this._onRemoveSuggestion }\n        onValidateInput={ this._validateInput }\n        componentRef={ this._setComponentRef }\n        onChange={ this._onPickerChange }\n        inputElement={ this._inputElement }\n        resolveDelay={ 300 }\n      />\n    );\n  }\n\n  private _setComponentRef = (component: IBaseFloatingPicker): void => {\n    this._picker = component;\n  }\n\n  private _onSearchChange = (newValue: string): void => {\n    if (newValue !== this.state.searchValue) {\n      this.setState({ searchValue: newValue });\n      this._picker.onQueryStringChanged(newValue);\n    }\n  }\n\n  private _onPickerChange = (selectedSuggestion: IPersonaProps): void => {\n    this.setState({ searchValue: selectedSuggestion.text ? selectedSuggestion.text : '' });\n    this._picker.hidePicker();\n  }\n\n  private _onRemoveSuggestion = (item: IPersonaProps): void => {\n    const { peopleList, mostRecentlyUsed: mruState } = this.state;\n    const indexPeopleList: number = peopleList.indexOf(item);\n    const indexMostRecentlyUsed: number = mruState.indexOf(item);\n\n    if (indexPeopleList >= 0) {\n      const newPeople: IPersonaProps[] = peopleList.slice(0, indexPeopleList).concat(peopleList.slice(indexPeopleList + 1));\n      this.setState({ peopleList: newPeople });\n    }\n\n    if (indexMostRecentlyUsed >= 0) {\n      const newSuggestedPeople: IPersonaProps[]\n        = mruState.slice(0, indexMostRecentlyUsed).concat(mruState.slice(indexMostRecentlyUsed + 1));\n      this.setState({ mostRecentlyUsed: newSuggestedPeople });\n    }\n  }\n\n  private _onFilterChanged = (filterText: string, currentPersonas: IPersonaProps[], limitResults?: number): IPersonaProps[] => {\n    if (filterText) {\n      let filteredPersonas: IPersonaProps[] = this._filterPersonasByText(filterText);\n\n      filteredPersonas = this._removeDuplicates(filteredPersonas, currentPersonas);\n      filteredPersonas = limitResults ? filteredPersonas.splice(0, limitResults) : filteredPersonas;\n      return filteredPersonas;\n    } else {\n      return [];\n    }\n  }\n\n  private _getTextFromItem(persona: IPersonaProps): string {\n    return persona.text as string;\n  }\n\n  private _listContainsPersona(persona: IPersonaProps, personas: IPersonaProps[]): boolean {\n    if (!personas || !personas.length || personas.length === 0) {\n      return false;\n    }\n    return personas.filter((item: IPersonaProps) => item.text === persona.text).length > 0;\n  }\n\n  private _filterPersonasByText(filterText: string): IPersonaProps[] {\n    return this.state.peopleList.filter((item: IPersonaProps) => this._doesTextStartWith(item.text as string, filterText));\n  }\n\n  private _doesTextStartWith(text: string, filterText: string): boolean {\n    return text.toLowerCase().indexOf(filterText.toLowerCase()) === 0;\n  }\n\n  private _removeDuplicates(personas: IPersonaProps[], possibleDupes: IPersonaProps[]): IPersonaProps[] {\n    return personas.filter((persona: IPersonaProps) => !this._listContainsPersona(persona, possibleDupes));\n  }\n\n  private _validateInput = (input: string): boolean => {\n    if (input.indexOf('@') !== -1) {\n      return true;\n    } else if (input.length > 1) {\n      return false;\n    } else {\n      return false;\n    }\n  }\n}"]}